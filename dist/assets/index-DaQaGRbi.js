const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/facephi-selphid.entry-BOONEIjw.js","assets/widget-pagination-layout-41df959c-iwQ4iQ6_.js","assets/widget-button-0c4173f6-C6Fx5L7V.js","assets/widget-header-fd036658-BGFyVQYI.js","assets/constants-864e3a0b-qovQjdBQ.js","assets/locale-61050ade-BR7FNr7M.js","assets/index-d7iOA4yy.js","assets/index-CzO0iaWU.css","assets/selphid-capture-view_5.entry-9OkuzTKr.js","assets/video-features-bd0e294f-CLTM3t-w.js","assets/selphid-browser-error_2.entry-Dmzc-Y2d.js","assets/selphid-camera.entry-tjGsG2Gn.js","assets/widget-animation_2.entry-BXlMgsN8.js","assets/arrow-next-icon_34.entry-BYDhNY4e.js"])))=>i.map(i=>d[i]);
import{_ as __vitePreload}from"./index-d7iOA4yy.js";var ResultStatus;(function(e){e.SUCCEEDED="SUCCEEDED",e.FAILED="FAILED",e.PENDING="PENDING",e.ERROR="ERROR"})(ResultStatus||(ResultStatus={}));const ERROR_DATA$1={status:ResultStatus.ERROR,faceMatch:{},passiveLiveness:{},personalInformation:{}},INFO_RESULT={[ResultStatus.SUCCEEDED]:{title:"Congratulations, we have validated your identity!",message:"The process has been completed"},[ResultStatus.FAILED]:{title:"Sorry, we couldn't validate your identity",message:"Warning! The process has failed"},[ResultStatus.PENDING]:{title:"Onboarding in progress",message:"We are analyzing the information"},[ResultStatus.ERROR]:{title:"Interrupted onboarding",message:"Warning! Connection error"}},NAMESPACE="selphid-widget",BUILD={experimentalSlotFixes:!1};var __defProp=Object.defineProperty,__export=(e,t)=>{for(var r in t)__defProp(e,r,{get:t[r],enumerable:!0})},EMPTY_OBJ={},SVG_NS="http://www.w3.org/2000/svg",HTML_NS="http://www.w3.org/1999/xhtml",isDef=e=>e!=null,isComplexType=e=>(e=typeof e,e==="object"||e==="function");function queryNonceMetaTagContent(e){var t,r,o;return(o=(r=(t=e.head)==null?void 0:t.querySelector('meta[name="csp-nonce"]'))==null?void 0:r.getAttribute("content"))!=null?o:void 0}var result_exports={};__export(result_exports,{err:()=>err,map:()=>map,ok:()=>ok,unwrap:()=>unwrap$1,unwrapErr:()=>unwrapErr});var ok=e=>({isOk:!0,isErr:!1,value:e}),err=e=>({isOk:!1,isErr:!0,value:e});function map(e,t){if(e.isOk){const r=t(e.value);return r instanceof Promise?r.then(o=>ok(o)):ok(r)}if(e.isErr){const r=e.value;return err(r)}throw"should never get here"}var unwrap$1=e=>{if(e.isOk)return e.value;throw e.value},unwrapErr=e=>{if(e.isErr)return e.value;throw e.value},createTime=(e,t="")=>()=>{},uniqueTime=(e,t)=>()=>{},HYDRATED_CSS="{visibility:hidden}.hydrated{visibility:inherit}",SLOT_FB_CSS="slot-fb{display:contents}slot-fb[hidden]{display:none}",h=(e,t,...r)=>{let o=null,l=null,f=null,n=!1,u=!1;const s=[],a=c=>{for(let m=0;m<c.length;m++)o=c[m],Array.isArray(o)?a(o):o!=null&&typeof o!="boolean"&&((n=typeof e!="function"&&!isComplexType(o))&&(o=String(o)),n&&u?s[s.length-1].$text$+=o:s.push(n?newVNode(null,o):o),u=n)};if(a(r),t){t.key&&(l=t.key),t.name&&(f=t.name);{const c=t.className||t.class;c&&(t.class=typeof c!="object"?c:Object.keys(c).filter(m=>c[m]).join(" "))}}if(typeof e=="function")return e(t===null?{}:t,s,vdomFnUtils);const d=newVNode(e,null);return d.$attrs$=t,s.length>0&&(d.$children$=s),d.$key$=l,d.$name$=f,d},newVNode=(e,t)=>{const r={$flags$:0,$tag$:e,$text$:t,$elm$:null,$children$:null};return r.$attrs$=null,r.$key$=null,r.$name$=null,r},Host={},isHost=e=>e&&e.$tag$===Host,vdomFnUtils={forEach:(e,t)=>e.map(convertToPublic).forEach(t),map:(e,t)=>e.map(convertToPublic).map(t).map(convertToPrivate)},convertToPublic=e=>({vattrs:e.$attrs$,vchildren:e.$children$,vkey:e.$key$,vname:e.$name$,vtag:e.$tag$,vtext:e.$text$}),convertToPrivate=e=>{if(typeof e.vtag=="function"){const r={...e.vattrs};return e.vkey&&(r.key=e.vkey),e.vname&&(r.name=e.vname),h(e.vtag,r,...e.vchildren||[])}const t=newVNode(e.vtag,e.vtext);return t.$attrs$=e.vattrs,t.$children$=e.vchildren,t.$key$=e.vkey,t.$name$=e.vname,t},parsePropertyValue=(e,t)=>e!=null&&!isComplexType(e)?t&4?e==="false"?!1:e===""||!!e:t&2?parseFloat(e):t&1?String(e):e:e,getElement=e=>getHostRef(e).$hostElement$,createEvent=(e,t,r)=>{const o=getElement(e);return{emit:l=>emitEvent(o,t,{bubbles:!0,composed:!0,cancelable:!0,detail:l})}},emitEvent=(e,t,r)=>{const o=plt.ce(t,r);return e.dispatchEvent(o),o},rootAppliedStyles=new WeakMap,registerStyle=(e,t,r)=>{let o=styles.get(e);supportsConstructableStylesheets&&r?(o=o||new CSSStyleSheet,typeof o=="string"?o=t:o.replaceSync(t)):o=t,styles.set(e,o)},addStyle=(e,t,r)=>{var o;const l=getScopeId(t),f=styles.get(l);if(e=e.nodeType===11?e:doc,f)if(typeof f=="string"){e=e.head||e;let n=rootAppliedStyles.get(e),u;if(n||rootAppliedStyles.set(e,n=new Set),!n.has(l)){{u=doc.createElement("style"),u.innerHTML=f;const s=(o=plt.$nonce$)!=null?o:queryNonceMetaTagContent(doc);s!=null&&u.setAttribute("nonce",s),e.insertBefore(u,e.querySelector("link"))}t.$flags$&4&&(u.innerHTML+=SLOT_FB_CSS),n&&n.add(l)}}else e.adoptedStyleSheets.includes(f)||(e.adoptedStyleSheets=[...e.adoptedStyleSheets,f]);return l},attachStyles=e=>{const t=e.$cmpMeta$,r=e.$hostElement$,o=t.$flags$,l=createTime("attachStyles",t.$tagName$),f=addStyle(r.shadowRoot?r.shadowRoot:r.getRootNode(),t);o&10&&(r["s-sc"]=f,r.classList.add(f+"-h"),o&2&&r.classList.add(f+"-s")),l()},getScopeId=(e,t)=>"sc-"+e.$tagName$,setAccessor=(e,t,r,o,l,f)=>{if(r!==o){let n=isMemberInElement(e,t),u=t.toLowerCase();if(t==="class"){const s=e.classList,a=parseClassList(r),d=parseClassList(o);s.remove(...a.filter(c=>c&&!d.includes(c))),s.add(...d.filter(c=>c&&!a.includes(c)))}else if(t==="style"){for(const s in r)(!o||o[s]==null)&&(s.includes("-")?e.style.removeProperty(s):e.style[s]="");for(const s in o)(!r||o[s]!==r[s])&&(s.includes("-")?e.style.setProperty(s,o[s]):e.style[s]=o[s])}else if(t!=="key")if(t==="ref")o&&o(e);else if(!n&&t[0]==="o"&&t[1]==="n"){if(t[2]==="-"?t=t.slice(3):isMemberInElement(win,u)?t=u.slice(2):t=u[2]+t.slice(3),r||o){const s=t.endsWith(CAPTURE_EVENT_SUFFIX);t=t.replace(CAPTURE_EVENT_REGEX,""),r&&plt.rel(e,t,r,s),o&&plt.ael(e,t,o,s)}}else{const s=isComplexType(o);if((n||s&&o!==null)&&!l)try{if(e.tagName.includes("-"))e[t]=o;else{const a=o??"";t==="list"?n=!1:(r==null||e[t]!=a)&&(e[t]=a)}}catch{}o==null||o===!1?(o!==!1||e.getAttribute(t)==="")&&e.removeAttribute(t):(!n||f&4||l)&&!s&&(o=o===!0?"":o,e.setAttribute(t,o))}}},parseClassListRegex=/\s/,parseClassList=e=>e?e.split(parseClassListRegex):[],CAPTURE_EVENT_SUFFIX="Capture",CAPTURE_EVENT_REGEX=new RegExp(CAPTURE_EVENT_SUFFIX+"$"),updateElement=(e,t,r)=>{const o=t.$elm$.nodeType===11&&t.$elm$.host?t.$elm$.host:t.$elm$,l=e&&e.$attrs$||EMPTY_OBJ,f=t.$attrs$||EMPTY_OBJ;for(const n of sortedAttrNames(Object.keys(l)))n in f||setAccessor(o,n,l[n],void 0,r,t.$flags$);for(const n of sortedAttrNames(Object.keys(f)))setAccessor(o,n,l[n],f[n],r,t.$flags$)};function sortedAttrNames(e){return e.includes("ref")?[...e.filter(t=>t!=="ref"),"ref"]:e}var scopeId,contentRef,hostTagName,useNativeShadowDom=!1,checkSlotFallbackVisibility=!1,checkSlotRelocate=!1,isSvgMode=!1,createElm=(e,t,r,o)=>{var l,f,n,u;const s=t.$children$[r];let a=0,d,c,m;if(useNativeShadowDom||(checkSlotRelocate=!0,s.$tag$==="slot"&&(scopeId&&o.classList.add(scopeId+"-s"),s.$flags$|=s.$children$?2:1)),s.$text$!==null)d=s.$elm$=doc.createTextNode(s.$text$);else if(s.$flags$&1)d=s.$elm$=doc.createTextNode("");else{isSvgMode||(isSvgMode=s.$tag$==="svg"),d=s.$elm$=doc.createElementNS(isSvgMode?SVG_NS:HTML_NS,s.$flags$&2?"slot-fb":s.$tag$),isSvgMode&&s.$tag$==="foreignObject"&&(isSvgMode=!1),updateElement(null,s,isSvgMode),isDef(scopeId)&&d["s-si"]!==scopeId&&d.classList.add(d["s-si"]=scopeId);{const p=((l=t.$elm$)==null?void 0:l["s-rsc"])||((f=t.$elm$)==null?void 0:f["s-si"])||((n=t.$elm$)==null?void 0:n["s-sc"]);p&&(d["s-rsc"]=p,!d.classList.contains(p)&&d.classList.add(p))}if(s.$children$)for(a=0;a<s.$children$.length;++a)c=createElm(e,s,a,d),c&&d.appendChild(c);s.$tag$==="svg"?isSvgMode=!1:d.tagName==="foreignObject"&&(isSvgMode=!0)}return d["s-hn"]=hostTagName,s.$flags$&3&&(d["s-sr"]=!0,d["s-cr"]=contentRef,d["s-sn"]=s.$name$||"",d["s-rf"]=(u=s.$attrs$)==null?void 0:u.ref,m=e&&e.$children$&&e.$children$[r],m&&m.$tag$===s.$tag$&&e.$elm$&&putBackInOriginalLocation(e.$elm$,!1)),d},putBackInOriginalLocation=(e,t)=>{plt.$flags$|=1;const r=Array.from(e.childNodes);e["s-sr"]&&BUILD.experimentalSlotFixes;for(let o=r.length-1;o>=0;o--){const l=r[o];l["s-hn"]!==hostTagName&&l["s-ol"]&&(parentReferenceNode(l).insertBefore(l,referenceNode(l)),l["s-ol"].remove(),l["s-ol"]=void 0,l["s-sh"]=void 0,checkSlotRelocate=!0),t&&putBackInOriginalLocation(l,t)}plt.$flags$&=-2},addVnodes=(e,t,r,o,l,f)=>{let n=e["s-cr"]&&e["s-cr"].parentNode||e,u;for(n.shadowRoot&&n.tagName===hostTagName&&(n=n.shadowRoot);l<=f;++l)o[l]&&(u=createElm(null,r,l,e),u&&(o[l].$elm$=u,n.insertBefore(u,referenceNode(t))))},removeVnodes=(e,t,r)=>{for(let o=t;o<=r;++o){const l=e[o];if(l){const f=l.$elm$;nullifyVNodeRefs(l),f&&(checkSlotFallbackVisibility=!0,f["s-ol"]?f["s-ol"].remove():putBackInOriginalLocation(f,!0),f.remove())}}},updateChildren=(e,t,r,o,l=!1)=>{let f=0,n=0,u=0,s=0,a=t.length-1,d=t[0],c=t[a],m=o.length-1,p=o[0],v=o[m],y,_;for(;f<=a&&n<=m;)if(d==null)d=t[++f];else if(c==null)c=t[--a];else if(p==null)p=o[++n];else if(v==null)v=o[--m];else if(isSameVnode(d,p,l))patch(d,p,l),d=t[++f],p=o[++n];else if(isSameVnode(c,v,l))patch(c,v,l),c=t[--a],v=o[--m];else if(isSameVnode(d,v,l))(d.$tag$==="slot"||v.$tag$==="slot")&&putBackInOriginalLocation(d.$elm$.parentNode,!1),patch(d,v,l),e.insertBefore(d.$elm$,c.$elm$.nextSibling),d=t[++f],v=o[--m];else if(isSameVnode(c,p,l))(d.$tag$==="slot"||v.$tag$==="slot")&&putBackInOriginalLocation(c.$elm$.parentNode,!1),patch(c,p,l),e.insertBefore(c.$elm$,d.$elm$),c=t[--a],p=o[++n];else{for(u=-1,s=f;s<=a;++s)if(t[s]&&t[s].$key$!==null&&t[s].$key$===p.$key$){u=s;break}u>=0?(_=t[u],_.$tag$!==p.$tag$?y=createElm(t&&t[n],r,u,e):(patch(_,p,l),t[u]=void 0,y=_.$elm$),p=o[++n]):(y=createElm(t&&t[n],r,n,e),p=o[++n]),y&&parentReferenceNode(d.$elm$).insertBefore(y,referenceNode(d.$elm$))}f>a?addVnodes(e,o[m+1]==null?null:o[m+1].$elm$,r,o,n,m):n>m&&removeVnodes(t,f,a)},isSameVnode=(e,t,r=!1)=>e.$tag$===t.$tag$?e.$tag$==="slot"?e.$name$===t.$name$:r?!0:e.$key$===t.$key$:!1,referenceNode=e=>e&&e["s-ol"]||e,parentReferenceNode=e=>(e["s-ol"]?e["s-ol"]:e).parentNode,patch=(e,t,r=!1)=>{const o=t.$elm$=e.$elm$,l=e.$children$,f=t.$children$,n=t.$tag$,u=t.$text$;let s;u===null?(isSvgMode=n==="svg"?!0:n==="foreignObject"?!1:isSvgMode,n==="slot"&&!useNativeShadowDom||updateElement(e,t,isSvgMode),l!==null&&f!==null?updateChildren(o,l,t,f,r):f!==null?(e.$text$!==null&&(o.textContent=""),addVnodes(o,null,t,f,0,f.length-1)):l!==null&&removeVnodes(l,0,l.length-1),isSvgMode&&n==="svg"&&(isSvgMode=!1)):(s=o["s-cr"])?s.parentNode.textContent=u:e.$text$!==u&&(o.data=u)},updateFallbackSlotVisibility=e=>{const t=e.childNodes;for(const r of t)if(r.nodeType===1){if(r["s-sr"]){const o=r["s-sn"];r.hidden=!1;for(const l of t)if(l!==r){if(l["s-hn"]!==r["s-hn"]||o!==""){if(l.nodeType===1&&(o===l.getAttribute("slot")||o===l["s-sn"])||l.nodeType===3&&o===l["s-sn"]){r.hidden=!0;break}}else if(l.nodeType===1||l.nodeType===3&&l.textContent.trim()!==""){r.hidden=!0;break}}}updateFallbackSlotVisibility(r)}},relocateNodes=[],markSlotContentForRelocation=e=>{let t,r,o;for(const l of e.childNodes){if(l["s-sr"]&&(t=l["s-cr"])&&t.parentNode){r=t.parentNode.childNodes;const f=l["s-sn"];for(o=r.length-1;o>=0;o--)if(t=r[o],!t["s-cn"]&&!t["s-nr"]&&t["s-hn"]!==l["s-hn"])if(isNodeLocatedInSlot(t,f)){let n=relocateNodes.find(u=>u.$nodeToRelocate$===t);checkSlotFallbackVisibility=!0,t["s-sn"]=t["s-sn"]||f,n?(n.$nodeToRelocate$["s-sh"]=l["s-hn"],n.$slotRefNode$=l):(t["s-sh"]=l["s-hn"],relocateNodes.push({$slotRefNode$:l,$nodeToRelocate$:t})),t["s-sr"]&&relocateNodes.map(u=>{isNodeLocatedInSlot(u.$nodeToRelocate$,t["s-sn"])&&(n=relocateNodes.find(s=>s.$nodeToRelocate$===t),n&&!u.$slotRefNode$&&(u.$slotRefNode$=n.$slotRefNode$))})}else relocateNodes.some(n=>n.$nodeToRelocate$===t)||relocateNodes.push({$nodeToRelocate$:t})}l.nodeType===1&&markSlotContentForRelocation(l)}},isNodeLocatedInSlot=(e,t)=>e.nodeType===1?e.getAttribute("slot")===null&&t===""||e.getAttribute("slot")===t:e["s-sn"]===t?!0:t==="",nullifyVNodeRefs=e=>{e.$attrs$&&e.$attrs$.ref&&e.$attrs$.ref(null),e.$children$&&e.$children$.map(nullifyVNodeRefs)},renderVdom=(e,t,r=!1)=>{var o,l,f,n;const u=e.$hostElement$,s=e.$cmpMeta$,a=e.$vnode$||newVNode(null,null),d=isHost(t)?t:h(null,null,t);if(hostTagName=u.tagName,r&&d.$attrs$)for(const c of Object.keys(d.$attrs$))u.hasAttribute(c)&&!["key","ref","style","class"].includes(c)&&(d.$attrs$[c]=u[c]);d.$tag$=null,d.$flags$|=4,e.$vnode$=d,d.$elm$=a.$elm$=u.shadowRoot||u,scopeId=u["s-sc"],useNativeShadowDom=(s.$flags$&1)!==0,contentRef=u["s-cr"],checkSlotFallbackVisibility=!1,patch(a,d,r);{if(plt.$flags$|=1,checkSlotRelocate){markSlotContentForRelocation(d.$elm$);for(const c of relocateNodes){const m=c.$nodeToRelocate$;if(!m["s-ol"]){const p=doc.createTextNode("");p["s-nr"]=m,m.parentNode.insertBefore(m["s-ol"]=p,m)}}for(const c of relocateNodes){const m=c.$nodeToRelocate$,p=c.$slotRefNode$;if(p){const v=p.parentNode;let y=p.nextSibling;{let _=(o=m["s-ol"])==null?void 0:o.previousSibling;for(;_;){let $=(l=_["s-nr"])!=null?l:null;if($&&$["s-sn"]===m["s-sn"]&&v===$.parentNode){for($=$.nextSibling;$===m||$!=null&&$["s-sr"];)$=$==null?void 0:$.nextSibling;if(!$||!$["s-nr"]){y=$;break}}_=_.previousSibling}}(!y&&v!==m.parentNode||m.nextSibling!==y)&&m!==y&&(!m["s-hn"]&&m["s-ol"]&&(m["s-hn"]=m["s-ol"].parentNode.nodeName),v.insertBefore(m,y),m.nodeType===1&&(m.hidden=(f=m["s-ih"])!=null?f:!1)),m&&typeof p["s-rf"]=="function"&&p["s-rf"](m)}else m.nodeType===1&&(r&&(m["s-ih"]=(n=m.hidden)!=null?n:!1),m.hidden=!0)}}checkSlotFallbackVisibility&&updateFallbackSlotVisibility(d.$elm$),plt.$flags$&=-2,relocateNodes.length=0}contentRef=void 0},attachToAncestor=(e,t)=>{t&&!e.$onRenderResolve$&&t["s-p"]&&t["s-p"].push(new Promise(r=>e.$onRenderResolve$=r))},scheduleUpdate=(e,t)=>{if(e.$flags$|=16,e.$flags$&4){e.$flags$|=512;return}return attachToAncestor(e,e.$ancestorComponent$),writeTask(()=>dispatchHooks(e,t))},dispatchHooks=(e,t)=>{const r=createTime("scheduleUpdate",e.$cmpMeta$.$tagName$),o=e.$lazyInstance$;let l;return t&&(e.$flags$|=256,e.$queuedListeners$&&(e.$queuedListeners$.map(([f,n])=>safeCall(o,f,n)),e.$queuedListeners$=void 0),l=safeCall(o,"componentWillLoad")),r(),enqueue(l,()=>updateComponent(e,o,t))},enqueue=(e,t)=>isPromisey(e)?e.then(t):t(),isPromisey=e=>e instanceof Promise||e&&e.then&&typeof e.then=="function",updateComponent=async(e,t,r)=>{var o;const l=e.$hostElement$,f=createTime("update",e.$cmpMeta$.$tagName$),n=l["s-rc"];r&&attachStyles(e);const u=createTime("render",e.$cmpMeta$.$tagName$);callRender(e,t,l,r),n&&(n.map(s=>s()),l["s-rc"]=void 0),u(),f();{const s=(o=l["s-p"])!=null?o:[],a=()=>postUpdateComponent(e);s.length===0?a():(Promise.all(s).then(a),e.$flags$|=4,s.length=0)}},renderingRef=null,callRender=(e,t,r,o)=>{try{renderingRef=t,t=t.render(),e.$flags$&=-17,e.$flags$|=2,renderVdom(e,t,o)}catch(l){consoleError(l,e.$hostElement$)}return renderingRef=null,null},getRenderingRef=()=>renderingRef,postUpdateComponent=e=>{const t=e.$cmpMeta$.$tagName$,r=e.$hostElement$,o=createTime("postUpdate",t),l=e.$lazyInstance$,f=e.$ancestorComponent$;safeCall(l,"componentDidRender"),e.$flags$&64?o():(e.$flags$|=64,addHydratedFlag(r),safeCall(l,"componentDidLoad"),o(),e.$onReadyResolve$(r),f||appDidLoad()),e.$onRenderResolve$&&(e.$onRenderResolve$(),e.$onRenderResolve$=void 0),e.$flags$&512&&nextTick(()=>scheduleUpdate(e,!1)),e.$flags$&=-517},forceUpdate=e=>{{const t=getHostRef(e),r=t.$hostElement$.isConnected;return r&&(t.$flags$&18)===2&&scheduleUpdate(t,!1),r}},appDidLoad=e=>{addHydratedFlag(doc.documentElement),nextTick(()=>emitEvent(win,"appload",{detail:{namespace:NAMESPACE}}))},safeCall=(e,t,r)=>{if(e&&e[t])try{return e[t](r)}catch(o){consoleError(o)}},addHydratedFlag=e=>e.classList.add("hydrated"),getValue=(e,t)=>getHostRef(e).$instanceValues$.get(t),setValue=(e,t,r,o)=>{const l=getHostRef(e),f=l.$hostElement$,n=l.$instanceValues$.get(t),u=l.$flags$,s=l.$lazyInstance$;r=parsePropertyValue(r,o.$members$[t][0]);const a=Number.isNaN(n)&&Number.isNaN(r),d=r!==n&&!a;if((!(u&8)||n===void 0)&&d&&(l.$instanceValues$.set(t,r),s)){if(o.$watchers$&&u&128){const c=o.$watchers$[t];c&&c.map(m=>{try{s[m](r,n,t)}catch(p){consoleError(p,f)}})}(u&18)===2&&scheduleUpdate(l,!1)}},proxyComponent=(e,t,r)=>{var o;const l=e.prototype;if(t.$members$){e.watchers&&(t.$watchers$=e.watchers);const f=Object.entries(t.$members$);if(f.map(([n,[u]])=>{(u&31||r&2&&u&32)&&Object.defineProperty(l,n,{get(){return getValue(this,n)},set(s){setValue(this,n,s,t)},configurable:!0,enumerable:!0})}),r&1){const n=new Map;l.attributeChangedCallback=function(u,s,a){plt.jmp(()=>{var d;const c=n.get(u);if(this.hasOwnProperty(c))a=this[c],delete this[c];else{if(l.hasOwnProperty(c)&&typeof this[c]=="number"&&this[c]==a)return;if(c==null){const m=getHostRef(this),p=m==null?void 0:m.$flags$;if(p&&!(p&8)&&p&128&&a!==s){const v=m.$lazyInstance$,y=(d=t.$watchers$)==null?void 0:d[u];y==null||y.forEach(_=>{v[_]!=null&&v[_].call(v,a,s,u)})}return}}this[c]=a===null&&typeof this[c]=="boolean"?!1:a})},e.observedAttributes=Array.from(new Set([...Object.keys((o=t.$watchers$)!=null?o:{}),...f.filter(([u,s])=>s[0]&15).map(([u,s])=>{const a=s[1]||u;return n.set(a,u),a})]))}}return e},initializeComponent=async(e,t,r,o)=>{let l;if((t.$flags$&32)===0){if(t.$flags$|=32,r.$lazyBundleId$){if(l=loadModule(r),l.then){const a=uniqueTime();l=await l,a()}l.isProxied||(r.$watchers$=l.watchers,proxyComponent(l,r,2),l.isProxied=!0);const s=createTime("createInstance",r.$tagName$);t.$flags$|=8;try{new l(t)}catch(a){consoleError(a)}t.$flags$&=-9,t.$flags$|=128,s()}else l=e.constructor,customElements.whenDefined(r.$tagName$).then(()=>t.$flags$|=128);if(l.style){let s=l.style;const a=getScopeId(r);if(!styles.has(a)){const d=createTime("registerStyles",r.$tagName$);registerStyle(a,s,!!(r.$flags$&1)),d()}}}const f=t.$ancestorComponent$,n=()=>scheduleUpdate(t,!0);f&&f["s-rc"]?f["s-rc"].push(n):n()},fireConnectedCallback=e=>{},connectedCallback=e=>{if((plt.$flags$&1)===0){const t=getHostRef(e),r=t.$cmpMeta$,o=createTime("connectedCallback",r.$tagName$);if(t.$flags$&1)addHostEventListeners(e,t,r.$listeners$),t!=null&&t.$lazyInstance$||t!=null&&t.$onReadyPromise$&&t.$onReadyPromise$.then(()=>fireConnectedCallback());else{t.$flags$|=1,r.$flags$&12&&setContentReference(e);{let l=e;for(;l=l.parentNode||l.host;)if(l["s-p"]){attachToAncestor(t,t.$ancestorComponent$=l);break}}r.$members$&&Object.entries(r.$members$).map(([l,[f]])=>{if(f&31&&e.hasOwnProperty(l)){const n=e[l];delete e[l],e[l]=n}}),initializeComponent(e,t,r)}o()}},setContentReference=e=>{const t=e["s-cr"]=doc.createComment("");t["s-cn"]=!0,e.insertBefore(t,e.firstChild)},disconnectInstance=e=>{safeCall(e,"disconnectedCallback")},disconnectedCallback=async e=>{if((plt.$flags$&1)===0){const t=getHostRef(e);t.$rmListeners$&&(t.$rmListeners$.map(r=>r()),t.$rmListeners$=void 0),t!=null&&t.$lazyInstance$?disconnectInstance(t.$lazyInstance$):t!=null&&t.$onReadyPromise$&&t.$onReadyPromise$.then(()=>disconnectInstance(t.$lazyInstance$))}},bootstrapLazy=(e,t={})=>{var r;const o=createTime(),l=[],f=t.exclude||[],n=win.customElements,u=doc.head,s=u.querySelector("meta[charset]"),a=doc.createElement("style"),d=[];let c,m=!0;Object.assign(plt,t),plt.$resourcesUrl$=new URL(t.resourcesUrl||"./",doc.baseURI).href;let p=!1;if(e.map(v=>{v[1].map(y=>{var _;const $={$flags$:y[0],$tagName$:y[1],$members$:y[2],$listeners$:y[3]};$.$flags$&4&&(p=!0),$.$members$=y[2],$.$listeners$=y[3],$.$watchers$=(_=y[4])!=null?_:{};const g=$.$tagName$,w=class extends HTMLElement{constructor(b){super(b),b=this,registerHost(b,$),$.$flags$&1&&b.attachShadow({mode:"open"})}connectedCallback(){c&&(clearTimeout(c),c=null),m?d.push(this):plt.jmp(()=>connectedCallback(this))}disconnectedCallback(){plt.jmp(()=>disconnectedCallback(this))}componentOnReady(){return getHostRef(this).$onReadyPromise$}};$.$lazyBundleId$=v[0],!f.includes(g)&&!n.get(g)&&(l.push(g),n.define(g,proxyComponent(w,$,1)))})}),l.length>0&&(p&&(a.textContent+=SLOT_FB_CSS),a.textContent+=l+HYDRATED_CSS,a.innerHTML.length)){a.setAttribute("data-styles","");const v=(r=plt.$nonce$)!=null?r:queryNonceMetaTagContent(doc);v!=null&&a.setAttribute("nonce",v),u.insertBefore(a,s?s.nextSibling:u.firstChild)}m=!1,d.length?d.map(v=>v.connectedCallback()):plt.jmp(()=>c=setTimeout(appDidLoad,30)),o()},Fragment=(e,t)=>t,addHostEventListeners=(e,t,r,o)=>{r&&r.map(([l,f,n])=>{const u=e,s=hostListenerProxy(t,n),a=hostListenerOpts(l);plt.ael(u,f,s,a),(t.$rmListeners$=t.$rmListeners$||[]).push(()=>plt.rel(u,f,s,a))})},hostListenerProxy=(e,t)=>r=>{try{e.$flags$&256?e.$lazyInstance$[t](r):(e.$queuedListeners$=e.$queuedListeners$||[]).push([t,r])}catch(o){consoleError(o)}},hostListenerOpts=e=>supportsListenerOptions?{passive:(e&1)!==0,capture:(e&2)!==0}:(e&2)!==0,hostRefs=new WeakMap,getHostRef=e=>hostRefs.get(e),registerInstance=(e,t)=>hostRefs.set(t.$lazyInstance$=e,t),registerHost=(e,t)=>{const r={$flags$:0,$hostElement$:e,$cmpMeta$:t,$instanceValues$:new Map};return r.$onReadyPromise$=new Promise(o=>r.$onReadyResolve$=o),e["s-p"]=[],e["s-rc"]=[],addHostEventListeners(e,r,t.$listeners$),hostRefs.set(e,r)},isMemberInElement=(e,t)=>t in e,consoleError=(e,t)=>(0,console.error)(e,t),cmpModules=new Map,loadModule=(e,t,r)=>{const o=e.$tagName$.replace(/-/g,"_"),l=e.$lazyBundleId$,f=cmpModules.get(l);if(f)return f[o];{const n=u=>(cmpModules.set(l,u),u[o]);switch(l){case"facephi-selphid":return __vitePreload(()=>import("./facephi-selphid.entry-BOONEIjw.js"),__vite__mapDeps([0,1,2,3,4,5,6,7])).then(n,consoleError);case"selphid-capture-view_5":return __vitePreload(()=>import("./selphid-capture-view_5.entry-9OkuzTKr.js"),__vite__mapDeps([8,4,5,9,6,7])).then(n,consoleError);case"selphid-browser-error_2":return __vitePreload(()=>import("./selphid-browser-error_2.entry-Dmzc-Y2d.js"),__vite__mapDeps([10,5,2,6,7])).then(n,consoleError);case"selphid-camera":return __vitePreload(()=>import("./selphid-camera.entry-tjGsG2Gn.js"),__vite__mapDeps([11,9,6,7])).then(n,consoleError);case"widget-animation_2":return __vitePreload(()=>import("./widget-animation_2.entry-BXlMgsN8.js"),__vite__mapDeps([12,6,7,1])).then(n,consoleError);case"arrow-next-icon_34":return __vitePreload(()=>import("./arrow-next-icon_34.entry-BYDhNY4e.js"),__vite__mapDeps([13,3,6,7])).then(n,consoleError)}}return __vitePreload(()=>import(`./${l}.entry.js`),[]).then(n=>(cmpModules.set(l,n),n[o]),consoleError)},styles=new Map,win=typeof window<"u"?window:{},doc=win.document||{head:{}},plt={$flags$:0,$resourcesUrl$:"",jmp:e=>e(),raf:e=>requestAnimationFrame(e),ael:(e,t,r,o)=>e.addEventListener(t,r,o),rel:(e,t,r,o)=>e.removeEventListener(t,r,o),ce:(e,t)=>new CustomEvent(e,t)},supportsListenerOptions=(()=>{let e=!1;try{doc.addEventListener("e",null,Object.defineProperty({},"passive",{get(){e=!0}}))}catch{}return e})(),promiseResolve=e=>Promise.resolve(e),supportsConstructableStylesheets=(()=>{try{return new CSSStyleSheet,typeof new CSSStyleSheet().replaceSync=="function"}catch{}return!1})(),queuePending=!1,queueDomReads=[],queueDomWrites=[],queueTask=(e,t)=>r=>{e.push(r),queuePending||(queuePending=!0,plt.$flags$&4?nextTick(flush):plt.raf(flush))},consume=e=>{for(let t=0;t<e.length;t++)try{e[t](performance.now())}catch(r){consoleError(r)}e.length=0},flush=()=>{consume(queueDomReads),consume(queueDomWrites),(queuePending=queueDomReads.length>0)&&plt.raf(flush)},nextTick=e=>promiseResolve().then(e),writeTask=queueTask(queueDomWrites);/*!
 * Built with Stencil
 * Copyright (c) 2023 Facephi Biometria, S.A.
 */const version="6.8.0";var ExceptionType;(function(e){e.AndroidWebViewBehaviour="AndroidWebViewBehaviour",e.UnknownInternalError="UnknownInternalError",e.CameraHardwareError="CameraHardwareError",e.CameraPermissionDenied="CameraPermissionDenied",e.MicrophonePermissionDenied="MicrophonePermissionDenied",e.SettingsError="SettingsError",e.BrowserApiNotCompatible="BrowserApiNotCompatible",e.ErrorTimeout="ErrorTimeout"})(ExceptionType||(ExceptionType={}));var Language;(function(e){e.ES="es",e.EN="en",e.PT="pt"})(Language||(Language={}));var ImageFormat;(function(e){e.PNG="image/png",e.JPEG="image/jpeg"})(ImageFormat||(ImageFormat={}));var CameraType;(function(e){e[e.User=0]="User",e[e.Environment=1]="Environment"})(CameraType||(CameraType={}));var DocumentType;(function(e){e[e.Autodetect=0]="Autodetect",e[e.IDCard=2]="IDCard",e[e.Passport=3]="Passport",e[e.DriverLicense=6]="DriverLicense",e[e.ResidentID=7]="ResidentID"})(DocumentType||(DocumentType={}));var ExpectedSides;(function(e){e[e.SingleSide=0]="SingleSide",e[e.Auto=1]="Auto"})(ExpectedSides||(ExpectedSides={}));var BarcodeSide;(function(e){e[e.Front=0]="Front",e[e.Back=1]="Back",e[e.Both=2]="Both"})(BarcodeSide||(BarcodeSide={}));var AnonymizationMode;(function(e){e[e.None=0]="None",e[e.ImageOnly=1]="ImageOnly",e[e.ResultFieldsOnly=2]="ResultFieldsOnly",e[e.FullResult=3]="FullResult"})(AnonymizationMode||(AnonymizationMode={}));var VideoRecordQuality;(function(e){e[e.Low=0]="Low",e[e.Medium=1]="Medium",e[e.High=2]="High"})(VideoRecordQuality||(VideoRecordQuality={}));var EngineDocumentTypes;(function(e){e.ID="ID",e.DL="DL",e.PASSPORT="PASSPORT"})(EngineDocumentTypes||(EngineDocumentTypes={}));var RuleName;(function(e){e.FirstName="firstName",e.LastName="lastName",e.Gender="gender",e.Nationality="nationality",e.PlaceOfBirth="placeOfBirth",e.DateOfBirth="dateOfBirth",e.DateOfIssue="dateOfIssue",e.DateOfExpiry="dateOfExpiry",e.DocumentNumber="documentNumber"})(RuleName||(RuleName={}));var RuleTypes;(function(e){e.EqualTo="equalTo",e.Contains="contains",e.Required="required",e.MaxLength="maxLength",e.MinLength="minLength",e.EqualLength="equalLength"})(RuleTypes||(RuleTypes={}));const WidgetVersion=version,DefaultEngineLocation="https://d2j9q1dw42kqvj.cloudfront.net/selphid/0.11.0";var WIDGETVIEWS;(function(e){e.Loading_View="loading-view",e.Selphid_Capture_View="selphid-capture-view",e.Selphid_Simple_View="selphid-simple-view",e.Preview_View="preview-view",e.Recording_View="recording-view",e.Tutorial_View="tutorial-view",e.Error_View="error-view"})(WIDGETVIEWS||(WIDGETVIEWS={}));var DocumentSide;(function(e){e[e.Front=0]="Front",e[e.Back=1]="Back"})(DocumentSide||(DocumentSide={}));var OperatingSystem;(function(e){e.Unknown="Unknown",e.WindowsPhone="Windows Phone",e.Android="Android",e.iOS="iOS"})(OperatingSystem||(OperatingSystem={}));const CAMERAWIDTH=1280,CAMERAHEIGHT=720,CROPFACTOR=1,CAPTUREPADDING=4,BLURREDTHRESHOLD=.1,CAPTURERETRIES=3,CAPTURETIMEOUT=10,ERRORTIMER=8,IMAGEQUALITY=.95,ASPECTRATIO="85.6 / 53.98",MAXALLOWEDMISMATCHES=0,PROGRESSIVEMISMATCHES=0,BROWSERLIST={Chrome:{id:1,icon:"ChromeBrowserIcon",name:"Chrome",version:"90.0.0",laptopRoute:"https://www.google.com/chrome/",iOSRoute:"https://apps.apple.com/es/app/google-chrome/id535886823",androidRoute:"https://play.google.com/store/search?q=chrome&c=apps&hl=es_419&gl=US"},Firefox:{id:2,icon:"FirefoxBrowserIcon",name:"Firefox",version:"90.0.0",laptopRoute:"https://www.mozilla.org/es-ES/firefox/new/",iOSRoute:"https://apps.apple.com/es/app/firefox-private-safe-browser/id989804926",androidRoute:"https://play.google.com/store/search?q=firefox&c=apps&hl=es_419&gl=US"},Edge:{id:3,icon:"EdgeBrowserIcon",name:"Edge",version:"90.0.0",laptopRoute:"https://www.microsoft.com/es-es/edge",iOSRoute:"https://apps.apple.com/es/app/microsoft-edge-chatea-con-gpt4/id1288723196",androidRoute:"https://play.google.com/store/search?q=edge&c=apps&hl=es_419&gl=US"},Safari:{id:4,icon:"SafariBrowserIcon",name:"Safari",version:"14.1.0",laptopRoute:"https://support.apple.com/es-es/HT201541#:~:text=Selecciona%20el%20men%C3%BA%20Apple%20%EF%A3%BF,clic%20en%20Actualizaci%C3%B3n%20de%20software.",iOSRoute:"https://support.apple.com/es-es/HT204204#:~:text=Actualizar%20el%20iPhone%20o%20iPad%20de%20forma%20inal%C3%A1mbrica&text=Enchufa%20el%20dispositivo%20a%20una,toca%20%E2%80%9CActualizaci%C3%B3n%20de%20software%E2%80%9D."}};var EVENT_TYPE;(function(e){e.ExtractionFinish="ExtractionFinish",e.WidgetLoaded="WidgetLoaded",e.UserCancel="UserCancel",e.TimeoutButtonClick="TimeoutButtonClick",e.TrackStatus="TrackStatus",e.ErrorTimeout="ErrorTimeout",e.GenerateNewRules="GenerateNewRules",e.ExceptionCaptured="ExceptionCaptured",e.ExtractionTimeout="ExtractionTimeout"})(EVENT_TYPE||(EVENT_TYPE={}));var TRACK_STATUS_TYPE;(function(e){e.CurrentState="currentState",e.TapButton="tapButton",e.RetriesConsumed="retriesConsumed",e.DocumentPresent="documentPresent"})(TRACK_STATUS_TYPE||(TRACK_STATUS_TYPE={}));var TAP_BUTTON_TYPE;(function(e){e.tutorial="tutorial",e.exit="exit",e.repeatExtraction="repeatExtraction",e.continueExtraction="continueExtraction",e.finishExtraction="finishExtraction",e.retryExtraction="retryExtraction",e.switchCamera="switchCamera",e.back="back"})(TAP_BUTTON_TYPE||(TAP_BUTTON_TYPE={}));const WIDGET_CONFIG={androidWebViewBehaviour:!1,advancedTracking:!0,allowUncertain:null,allowUnknown:!1,anonymizationMode:AnonymizationMode.None,audible:"",barcode:null,barcodeSide:BarcodeSide.Both,blurredThreshold:BLURREDTHRESHOLD,cameraHeight:CAMERAHEIGHT,cameraId:"",cameraOverflow:!1,cameraSwitch:!0,cameraType:CameraType.Environment,cameraWidth:CAMERAWIDTH,capturePadding:CAPTUREPADDING,captureRetries:CAPTURERETRIES,captureTimeout:CAPTURETIMEOUT,countryFilter:null,cropFactor:CROPFACTOR,debug:!1,debugException:"",disableExit:!1,disableTutorial:!1,documentType:[DocumentType.Autodetect],engineFallback:!1,engineLocation:"",errorTimer:ERRORTIMER,expectedSides:ExpectedSides.Auto,externalCamera:null,graphicResources:{loadingAnimation:"",tutorialAnimations:[],logo:""},imageFormat:ImageFormat.PNG,imageQuality:IMAGEQUALITY,keepEngineAlive:!1,language:Language.ES,licenseKey:"",maxAllowedMismatches:MAXALLOWEDMISMATCHES,previewImage:!0,progressiveMismatches:PROGRESSIVEMISMATCHES,retryCurrentSide:!1,rules:null,settingsStrictness:!0,showLog:!1,tokenizerLocation:"",videoRecord:!1,videoRecordAudio:!1,videoRecordQuality:VideoRecordQuality.Medium},DIAGNOSTIC_ICONS={OkIcon:"ValidationOkIcon",WarnIcon:"ValidationWarnIcon",FailIcon:"ValidationFailIcon"},DIAGNOSTIC_DATA={2:{title:"Avoid tilting the document",iconName:DIAGNOSTIC_ICONS.WarnIcon},3:{title:"Too far",iconName:DIAGNOSTIC_ICONS.WarnIcon},4:{title:"Very close",iconName:DIAGNOSTIC_ICONS.WarnIcon},5:{title:"Out of bounds",iconName:DIAGNOSTIC_ICONS.WarnIcon}},FILTER_FAILED_DATA={title:"Document not supported",iconName:DIAGNOSTIC_ICONS.WarnIcon},TUTORIAL_SLIDE_TEXTS=["Hold the document from the edge so as not to cover the data.","Place the document in the box.","Avoid glare that makes the document difficult to read."],TUTORIAL_SLIDE_ALTS=["A hand holds an identity document. His/her fingers cover some data. Then, he/she corrects the position of his/her fingers and the document can be read clearly","Capture of a document. It shows the front of a document, placed inside a box. Then, it repeats the same step, showing the back of the document","An identity document, seen from the front. When tilted, reflections appear on the document"],ERROR_DATA={UnknownInternalError:{title:"There was a technical problem",detail:"We apologize. We are working to solve it. Try again later.",icon:"ErrorGenericIcon"},AndroidWebViewBehaviour:{title:"You are using WebView",detail:"We are going to open an external browser to improve user experience",icon:"ErrorBrowserIcon"},CameraHardwareError:{title:"Camera problem",detail:"We cannot access the camera. Please try with another device.",icon:"ErrorCameraIcon"},CameraPermissionDenied:{title:"Allow access to the camera",detail:"To capture the images we need you to activate this permission.",icon:"ErrorCameraIcon"},MicrophonePermissionDenied:{title:"Allow access to the camera and microphone",detail:"To capture the video with audio, we need you to activate this permissions.",icon:"ErrorCameraIcon"},BrowserApiNotCompatible:{title:"Your browser is not compatible",detail:"Please use a different browser to continue the process",icon:"ErrorBrowserIcon"},SettingsError:{title:"There is a configuration error",detail:"Check the console to locate the error",icon:"ErrorGenericIcon"},ErrorTimeout:{title:"Time exceeded",detail:"Check that the document is inside the box and the data are visible.",icon:"ErrorTimeoutIcon"}};var byteToHex=[];for(var i=0;i<256;++i)byteToHex.push((i+256).toString(16).slice(1));function unsafeStringify(e,t=0){return(byteToHex[e[t+0]]+byteToHex[e[t+1]]+byteToHex[e[t+2]]+byteToHex[e[t+3]]+"-"+byteToHex[e[t+4]]+byteToHex[e[t+5]]+"-"+byteToHex[e[t+6]]+byteToHex[e[t+7]]+"-"+byteToHex[e[t+8]]+byteToHex[e[t+9]]+"-"+byteToHex[e[t+10]]+byteToHex[e[t+11]]+byteToHex[e[t+12]]+byteToHex[e[t+13]]+byteToHex[e[t+14]]+byteToHex[e[t+15]]).toLowerCase()}var getRandomValues,rnds8=new Uint8Array(16);function rng(){if(!getRandomValues&&(getRandomValues=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!getRandomValues))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return getRandomValues(rnds8)}var randomUUID=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const native={randomUUID};function v4(e,t,r){if(native.randomUUID&&!e)return native.randomUUID();e=e||{};var o=e.random||(e.rng||rng)();return o[6]=o[6]&15|64,o[8]=o[8]&63|128,unsafeStringify(o)}var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},src={exports:{}},indexLight={exports:{}},indexMinimal={},minimal={},aspromise=asPromise;function asPromise(e,t){for(var r=new Array(arguments.length-1),o=0,l=2,f=!0;l<arguments.length;)r[o++]=arguments[l++];return new Promise(function(u,s){r[o]=function(d){if(f)if(f=!1,d)s(d);else{for(var c=new Array(arguments.length-1),m=0;m<c.length;)c[m++]=arguments[m];u.apply(null,c)}};try{e.apply(t||null,r)}catch(a){f&&(f=!1,s(a))}})}var base64$1={};(function(e){var t=e;t.length=function(u){var s=u.length;if(!s)return 0;for(var a=0;--s%4>1&&u.charAt(s)==="=";)++a;return Math.ceil(u.length*3)/4-a};for(var r=new Array(64),o=new Array(123),l=0;l<64;)o[r[l]=l<26?l+65:l<52?l+71:l<62?l-4:l-59|43]=l++;t.encode=function(u,s,a){for(var d=null,c=[],m=0,p=0,v;s<a;){var y=u[s++];switch(p){case 0:c[m++]=r[y>>2],v=(y&3)<<4,p=1;break;case 1:c[m++]=r[v|y>>4],v=(y&15)<<2,p=2;break;case 2:c[m++]=r[v|y>>6],c[m++]=r[y&63],p=0;break}m>8191&&((d||(d=[])).push(String.fromCharCode.apply(String,c)),m=0)}return p&&(c[m++]=r[v],c[m++]=61,p===1&&(c[m++]=61)),d?(m&&d.push(String.fromCharCode.apply(String,c.slice(0,m))),d.join("")):String.fromCharCode.apply(String,c.slice(0,m))};var f="invalid encoding";t.decode=function(u,s,a){for(var d=a,c=0,m,p=0;p<u.length;){var v=u.charCodeAt(p++);if(v===61&&c>1)break;if((v=o[v])===void 0)throw Error(f);switch(c){case 0:m=v,c=1;break;case 1:s[a++]=m<<2|(v&48)>>4,m=v,c=2;break;case 2:s[a++]=(m&15)<<4|(v&60)>>2,m=v,c=3;break;case 3:s[a++]=(m&3)<<6|v,c=0;break}}if(c===1)throw Error(f);return a-d},t.test=function(u){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(u)}})(base64$1);var eventemitter=EventEmitter;function EventEmitter(){this._listeners={}}EventEmitter.prototype.on=function(t,r,o){return(this._listeners[t]||(this._listeners[t]=[])).push({fn:r,ctx:o||this}),this};EventEmitter.prototype.off=function(t,r){if(t===void 0)this._listeners={};else if(r===void 0)this._listeners[t]=[];else for(var o=this._listeners[t],l=0;l<o.length;)o[l].fn===r?o.splice(l,1):++l;return this};EventEmitter.prototype.emit=function(t){var r=this._listeners[t];if(r){for(var o=[],l=1;l<arguments.length;)o.push(arguments[l++]);for(l=0;l<r.length;)r[l].fn.apply(r[l++].ctx,o)}return this};var float=factory(factory);function factory(e){return typeof Float32Array<"u"?function(){var t=new Float32Array([-0]),r=new Uint8Array(t.buffer),o=r[3]===128;function l(s,a,d){t[0]=s,a[d]=r[0],a[d+1]=r[1],a[d+2]=r[2],a[d+3]=r[3]}function f(s,a,d){t[0]=s,a[d]=r[3],a[d+1]=r[2],a[d+2]=r[1],a[d+3]=r[0]}e.writeFloatLE=o?l:f,e.writeFloatBE=o?f:l;function n(s,a){return r[0]=s[a],r[1]=s[a+1],r[2]=s[a+2],r[3]=s[a+3],t[0]}function u(s,a){return r[3]=s[a],r[2]=s[a+1],r[1]=s[a+2],r[0]=s[a+3],t[0]}e.readFloatLE=o?n:u,e.readFloatBE=o?u:n}():function(){function t(o,l,f,n){var u=l<0?1:0;if(u&&(l=-l),l===0)o(1/l>0?0:2147483648,f,n);else if(isNaN(l))o(2143289344,f,n);else if(l>34028234663852886e22)o((u<<31|2139095040)>>>0,f,n);else if(l<11754943508222875e-54)o((u<<31|Math.round(l/1401298464324817e-60))>>>0,f,n);else{var s=Math.floor(Math.log(l)/Math.LN2),a=Math.round(l*Math.pow(2,-s)*8388608)&8388607;o((u<<31|s+127<<23|a)>>>0,f,n)}}e.writeFloatLE=t.bind(null,writeUintLE),e.writeFloatBE=t.bind(null,writeUintBE);function r(o,l,f){var n=o(l,f),u=(n>>31)*2+1,s=n>>>23&255,a=n&8388607;return s===255?a?NaN:u*(1/0):s===0?u*1401298464324817e-60*a:u*Math.pow(2,s-150)*(a+8388608)}e.readFloatLE=r.bind(null,readUintLE),e.readFloatBE=r.bind(null,readUintBE)}(),typeof Float64Array<"u"?function(){var t=new Float64Array([-0]),r=new Uint8Array(t.buffer),o=r[7]===128;function l(s,a,d){t[0]=s,a[d]=r[0],a[d+1]=r[1],a[d+2]=r[2],a[d+3]=r[3],a[d+4]=r[4],a[d+5]=r[5],a[d+6]=r[6],a[d+7]=r[7]}function f(s,a,d){t[0]=s,a[d]=r[7],a[d+1]=r[6],a[d+2]=r[5],a[d+3]=r[4],a[d+4]=r[3],a[d+5]=r[2],a[d+6]=r[1],a[d+7]=r[0]}e.writeDoubleLE=o?l:f,e.writeDoubleBE=o?f:l;function n(s,a){return r[0]=s[a],r[1]=s[a+1],r[2]=s[a+2],r[3]=s[a+3],r[4]=s[a+4],r[5]=s[a+5],r[6]=s[a+6],r[7]=s[a+7],t[0]}function u(s,a){return r[7]=s[a],r[6]=s[a+1],r[5]=s[a+2],r[4]=s[a+3],r[3]=s[a+4],r[2]=s[a+5],r[1]=s[a+6],r[0]=s[a+7],t[0]}e.readDoubleLE=o?n:u,e.readDoubleBE=o?u:n}():function(){function t(o,l,f,n,u,s){var a=n<0?1:0;if(a&&(n=-n),n===0)o(0,u,s+l),o(1/n>0?0:2147483648,u,s+f);else if(isNaN(n))o(0,u,s+l),o(2146959360,u,s+f);else if(n>17976931348623157e292)o(0,u,s+l),o((a<<31|2146435072)>>>0,u,s+f);else{var d;if(n<22250738585072014e-324)d=n/5e-324,o(d>>>0,u,s+l),o((a<<31|d/4294967296)>>>0,u,s+f);else{var c=Math.floor(Math.log(n)/Math.LN2);c===1024&&(c=1023),d=n*Math.pow(2,-c),o(d*4503599627370496>>>0,u,s+l),o((a<<31|c+1023<<20|d*1048576&1048575)>>>0,u,s+f)}}}e.writeDoubleLE=t.bind(null,writeUintLE,0,4),e.writeDoubleBE=t.bind(null,writeUintBE,4,0);function r(o,l,f,n,u){var s=o(n,u+l),a=o(n,u+f),d=(a>>31)*2+1,c=a>>>20&2047,m=4294967296*(a&1048575)+s;return c===2047?m?NaN:d*(1/0):c===0?d*5e-324*m:d*Math.pow(2,c-1075)*(m+4503599627370496)}e.readDoubleLE=r.bind(null,readUintLE,0,4),e.readDoubleBE=r.bind(null,readUintBE,4,0)}(),e}function writeUintLE(e,t,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}function writeUintBE(e,t,r){t[r]=e>>>24,t[r+1]=e>>>16&255,t[r+2]=e>>>8&255,t[r+3]=e&255}function readUintLE(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function readUintBE(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}var inquire_1=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}var utf8$2={};(function(e){var t=e;t.length=function(o){for(var l=0,f=0,n=0;n<o.length;++n)f=o.charCodeAt(n),f<128?l+=1:f<2048?l+=2:(f&64512)===55296&&(o.charCodeAt(n+1)&64512)===56320?(++n,l+=4):l+=3;return l},t.read=function(o,l,f){var n=f-l;if(n<1)return"";for(var u=null,s=[],a=0,d;l<f;)d=o[l++],d<128?s[a++]=d:d>191&&d<224?s[a++]=(d&31)<<6|o[l++]&63:d>239&&d<365?(d=((d&7)<<18|(o[l++]&63)<<12|(o[l++]&63)<<6|o[l++]&63)-65536,s[a++]=55296+(d>>10),s[a++]=56320+(d&1023)):s[a++]=(d&15)<<12|(o[l++]&63)<<6|o[l++]&63,a>8191&&((u||(u=[])).push(String.fromCharCode.apply(String,s)),a=0);return u?(a&&u.push(String.fromCharCode.apply(String,s.slice(0,a))),u.join("")):String.fromCharCode.apply(String,s.slice(0,a))},t.write=function(o,l,f){for(var n=f,u,s,a=0;a<o.length;++a)u=o.charCodeAt(a),u<128?l[f++]=u:u<2048?(l[f++]=u>>6|192,l[f++]=u&63|128):(u&64512)===55296&&((s=o.charCodeAt(a+1))&64512)===56320?(u=65536+((u&1023)<<10)+(s&1023),++a,l[f++]=u>>18|240,l[f++]=u>>12&63|128,l[f++]=u>>6&63|128,l[f++]=u&63|128):(l[f++]=u>>12|224,l[f++]=u>>6&63|128,l[f++]=u&63|128);return f-n}})(utf8$2);var pool_1=pool;function pool(e,t,r){var o=r||8192,l=o>>>1,f=null,n=o;return function(s){if(s<1||s>l)return e(s);n+s>o&&(f=e(o),n=0);var a=t.call(f,n,n+=s);return n&7&&(n=(n|7)+1),a}}var longbits,hasRequiredLongbits;function requireLongbits(){if(hasRequiredLongbits)return longbits;hasRequiredLongbits=1,longbits=t;var e=requireMinimal();function t(f,n){this.lo=f>>>0,this.hi=n>>>0}var r=t.zero=new t(0,0);r.toNumber=function(){return 0},r.zzEncode=r.zzDecode=function(){return this},r.length=function(){return 1};var o=t.zeroHash="\0\0\0\0\0\0\0\0";t.fromNumber=function(n){if(n===0)return r;var u=n<0;u&&(n=-n);var s=n>>>0,a=(n-s)/4294967296>>>0;return u&&(a=~a>>>0,s=~s>>>0,++s>4294967295&&(s=0,++a>4294967295&&(a=0))),new t(s,a)},t.from=function(n){if(typeof n=="number")return t.fromNumber(n);if(e.isString(n))if(e.Long)n=e.Long.fromString(n);else return t.fromNumber(parseInt(n,10));return n.low||n.high?new t(n.low>>>0,n.high>>>0):r},t.prototype.toNumber=function(n){if(!n&&this.hi>>>31){var u=~this.lo+1>>>0,s=~this.hi>>>0;return u||(s=s+1>>>0),-(u+s*4294967296)}return this.lo+this.hi*4294967296},t.prototype.toLong=function(n){return e.Long?new e.Long(this.lo|0,this.hi|0,!!n):{low:this.lo|0,high:this.hi|0,unsigned:!!n}};var l=String.prototype.charCodeAt;return t.fromHash=function(n){return n===o?r:new t((l.call(n,0)|l.call(n,1)<<8|l.call(n,2)<<16|l.call(n,3)<<24)>>>0,(l.call(n,4)|l.call(n,5)<<8|l.call(n,6)<<16|l.call(n,7)<<24)>>>0)},t.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},t.prototype.zzEncode=function(){var n=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^n)>>>0,this.lo=(this.lo<<1^n)>>>0,this},t.prototype.zzDecode=function(){var n=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^n)>>>0,this.hi=(this.hi>>>1^n)>>>0,this},t.prototype.length=function(){var n=this.lo,u=(this.lo>>>28|this.hi<<4)>>>0,s=this.hi>>>24;return s===0?u===0?n<16384?n<128?1:2:n<2097152?3:4:u<16384?u<128?5:6:u<2097152?7:8:s<128?9:10},longbits}var hasRequiredMinimal;function requireMinimal(){return hasRequiredMinimal||(hasRequiredMinimal=1,function(e){var t=e;t.asPromise=aspromise,t.base64=base64$1,t.EventEmitter=eventemitter,t.float=float,t.inquire=inquire_1,t.utf8=utf8$2,t.pool=pool_1,t.LongBits=requireLongbits(),t.isNode=!!(typeof commonjsGlobal<"u"&&commonjsGlobal&&commonjsGlobal.process&&commonjsGlobal.process.versions&&commonjsGlobal.process.versions.node),t.global=t.isNode&&commonjsGlobal||typeof window<"u"&&window||typeof self<"u"&&self||commonjsGlobal,t.emptyArray=Object.freeze?Object.freeze([]):[],t.emptyObject=Object.freeze?Object.freeze({}):{},t.isInteger=Number.isInteger||function(f){return typeof f=="number"&&isFinite(f)&&Math.floor(f)===f},t.isString=function(f){return typeof f=="string"||f instanceof String},t.isObject=function(f){return f&&typeof f=="object"},t.isset=t.isSet=function(f,n){var u=f[n];return u!=null&&f.hasOwnProperty(n)?typeof u!="object"||(Array.isArray(u)?u.length:Object.keys(u).length)>0:!1},t.Buffer=function(){try{var l=t.inquire("buffer").Buffer;return l.prototype.utf8Write?l:null}catch{return null}}(),t._Buffer_from=null,t._Buffer_allocUnsafe=null,t.newBuffer=function(f){return typeof f=="number"?t.Buffer?t._Buffer_allocUnsafe(f):new t.Array(f):t.Buffer?t._Buffer_from(f):typeof Uint8Array>"u"?f:new Uint8Array(f)},t.Array=typeof Uint8Array<"u"?Uint8Array:Array,t.Long=t.global.dcodeIO&&t.global.dcodeIO.Long||t.global.Long||t.inquire("long"),t.key2Re=/^true|false|0|1$/,t.key32Re=/^-?(?:0|[1-9][0-9]*)$/,t.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,t.longToHash=function(f){return f?t.LongBits.from(f).toHash():t.LongBits.zeroHash},t.longFromHash=function(f,n){var u=t.LongBits.fromHash(f);return t.Long?t.Long.fromBits(u.lo,u.hi,n):u.toNumber(!!n)};function r(l,f,n){for(var u=Object.keys(f),s=0;s<u.length;++s)(l[u[s]]===void 0||!n)&&(l[u[s]]=f[u[s]]);return l}t.merge=r,t.lcFirst=function(f){return f.charAt(0).toLowerCase()+f.substring(1)};function o(l){function f(n,u){if(!(this instanceof f))return new f(n,u);Object.defineProperty(this,"message",{get:function(){return n}}),Error.captureStackTrace?Error.captureStackTrace(this,f):Object.defineProperty(this,"stack",{value:new Error().stack||""}),u&&r(this,u)}return f.prototype=Object.create(Error.prototype,{constructor:{value:f,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return l},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),f}t.newError=o,t.ProtocolError=o("ProtocolError"),t.oneOfGetter=function(f){for(var n={},u=0;u<f.length;++u)n[f[u]]=1;return function(){for(var s=Object.keys(this),a=s.length-1;a>-1;--a)if(n[s[a]]===1&&this[s[a]]!==void 0&&this[s[a]]!==null)return s[a]}},t.oneOfSetter=function(f){return function(n){for(var u=0;u<f.length;++u)f[u]!==n&&delete this[f[u]]}},t.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},t._configure=function(){var l=t.Buffer;if(!l){t._Buffer_from=t._Buffer_allocUnsafe=null;return}t._Buffer_from=l.from!==Uint8Array.from&&l.from||function(n,u){return new l(n,u)},t._Buffer_allocUnsafe=l.allocUnsafe||function(n){return new l(n)}}}(minimal)),minimal}var writer=Writer$1,util$7=requireMinimal(),BufferWriter$1,LongBits$1=util$7.LongBits,base64=util$7.base64,utf8$1=util$7.utf8;function Op(e,t,r){this.fn=e,this.len=t,this.next=void 0,this.val=r}function noop(){}function State(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function Writer$1(){this.len=0,this.head=new Op(noop,0,0),this.tail=this.head,this.states=null}var create$1=function e(){return util$7.Buffer?function(){return(Writer$1.create=function(){return new BufferWriter$1})()}:function(){return new Writer$1}};Writer$1.create=create$1();Writer$1.alloc=function e(t){return new util$7.Array(t)};util$7.Array!==Array&&(Writer$1.alloc=util$7.pool(Writer$1.alloc,util$7.Array.prototype.subarray));Writer$1.prototype._push=function e(t,r,o){return this.tail=this.tail.next=new Op(t,r,o),this.len+=r,this};function writeByte(e,t,r){t[r]=e&255}function writeVarint32(e,t,r){for(;e>127;)t[r++]=e&127|128,e>>>=7;t[r]=e}function VarintOp(e,t){this.len=e,this.next=void 0,this.val=t}VarintOp.prototype=Object.create(Op.prototype);VarintOp.prototype.fn=writeVarint32;Writer$1.prototype.uint32=function e(t){return this.len+=(this.tail=this.tail.next=new VarintOp((t=t>>>0)<128?1:t<16384?2:t<2097152?3:t<268435456?4:5,t)).len,this};Writer$1.prototype.int32=function e(t){return t<0?this._push(writeVarint64,10,LongBits$1.fromNumber(t)):this.uint32(t)};Writer$1.prototype.sint32=function e(t){return this.uint32((t<<1^t>>31)>>>0)};function writeVarint64(e,t,r){for(;e.hi;)t[r++]=e.lo&127|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[r++]=e.lo&127|128,e.lo=e.lo>>>7;t[r++]=e.lo}Writer$1.prototype.uint64=function e(t){var r=LongBits$1.from(t);return this._push(writeVarint64,r.length(),r)};Writer$1.prototype.int64=Writer$1.prototype.uint64;Writer$1.prototype.sint64=function e(t){var r=LongBits$1.from(t).zzEncode();return this._push(writeVarint64,r.length(),r)};Writer$1.prototype.bool=function e(t){return this._push(writeByte,1,t?1:0)};function writeFixed32(e,t,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}Writer$1.prototype.fixed32=function e(t){return this._push(writeFixed32,4,t>>>0)};Writer$1.prototype.sfixed32=Writer$1.prototype.fixed32;Writer$1.prototype.fixed64=function e(t){var r=LongBits$1.from(t);return this._push(writeFixed32,4,r.lo)._push(writeFixed32,4,r.hi)};Writer$1.prototype.sfixed64=Writer$1.prototype.fixed64;Writer$1.prototype.float=function e(t){return this._push(util$7.float.writeFloatLE,4,t)};Writer$1.prototype.double=function e(t){return this._push(util$7.float.writeDoubleLE,8,t)};var writeBytes=util$7.Array.prototype.set?function e(t,r,o){r.set(t,o)}:function e(t,r,o){for(var l=0;l<t.length;++l)r[o+l]=t[l]};Writer$1.prototype.bytes=function e(t){var r=t.length>>>0;if(!r)return this._push(writeByte,1,0);if(util$7.isString(t)){var o=Writer$1.alloc(r=base64.length(t));base64.decode(t,o,0),t=o}return this.uint32(r)._push(writeBytes,r,t)};Writer$1.prototype.string=function e(t){var r=utf8$1.length(t);return r?this.uint32(r)._push(utf8$1.write,r,t):this._push(writeByte,1,0)};Writer$1.prototype.fork=function e(){return this.states=new State(this),this.head=this.tail=new Op(noop,0,0),this.len=0,this};Writer$1.prototype.reset=function e(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Op(noop,0,0),this.len=0),this};Writer$1.prototype.ldelim=function e(){var t=this.head,r=this.tail,o=this.len;return this.reset().uint32(o),o&&(this.tail.next=t.next,this.tail=r,this.len+=o),this};Writer$1.prototype.finish=function e(){for(var t=this.head.next,r=this.constructor.alloc(this.len),o=0;t;)t.fn(t.val,r,o),o+=t.len,t=t.next;return r};Writer$1._configure=function(e){BufferWriter$1=e,Writer$1.create=create$1(),BufferWriter$1._configure()};var writer_buffer=BufferWriter,Writer=writer;(BufferWriter.prototype=Object.create(Writer.prototype)).constructor=BufferWriter;var util$6=requireMinimal();function BufferWriter(){Writer.call(this)}BufferWriter._configure=function(){BufferWriter.alloc=util$6._Buffer_allocUnsafe,BufferWriter.writeBytesBuffer=util$6.Buffer&&util$6.Buffer.prototype instanceof Uint8Array&&util$6.Buffer.prototype.set.name==="set"?function(t,r,o){r.set(t,o)}:function(t,r,o){if(t.copy)t.copy(r,o,0,t.length);else for(var l=0;l<t.length;)r[o++]=t[l++]}};BufferWriter.prototype.bytes=function e(t){util$6.isString(t)&&(t=util$6._Buffer_from(t,"base64"));var r=t.length>>>0;return this.uint32(r),r&&this._push(BufferWriter.writeBytesBuffer,r,t),this};function writeStringBuffer(e,t,r){e.length<40?util$6.utf8.write(e,t,r):t.utf8Write?t.utf8Write(e,r):t.write(e,r)}BufferWriter.prototype.string=function e(t){var r=util$6.Buffer.byteLength(t);return this.uint32(r),r&&this._push(writeStringBuffer,r,t),this};BufferWriter._configure();var reader=Reader$1,util$5=requireMinimal(),BufferReader$1,LongBits=util$5.LongBits,utf8=util$5.utf8;function indexOutOfRange(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function Reader$1(e){this.buf=e,this.pos=0,this.len=e.length}var create_array=typeof Uint8Array<"u"?function e(t){if(t instanceof Uint8Array||Array.isArray(t))return new Reader$1(t);throw Error("illegal buffer")}:function e(t){if(Array.isArray(t))return new Reader$1(t);throw Error("illegal buffer")},create=function e(){return util$5.Buffer?function(r){return(Reader$1.create=function(l){return util$5.Buffer.isBuffer(l)?new BufferReader$1(l):create_array(l)})(r)}:create_array};Reader$1.create=create();Reader$1.prototype._slice=util$5.Array.prototype.subarray||util$5.Array.prototype.slice;Reader$1.prototype.uint32=function e(){var t=4294967295;return function(){if(t=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(t=(t|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return t;if((this.pos+=5)>this.len)throw this.pos=this.len,indexOutOfRange(this,10);return t}}();Reader$1.prototype.int32=function e(){return this.uint32()|0};Reader$1.prototype.sint32=function e(){var t=this.uint32();return t>>>1^-(t&1)|0};function readLongVarint(){var e=new LongBits(0,0),t=0;if(this.len-this.pos>4){for(;t<4;++t)if(e.lo=(e.lo|(this.buf[this.pos]&127)<<t*7)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(this.buf[this.pos]&127)<<28)>>>0,e.hi=(e.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return e;t=0}else{for(;t<3;++t){if(this.pos>=this.len)throw indexOutOfRange(this);if(e.lo=(e.lo|(this.buf[this.pos]&127)<<t*7)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(this.buf[this.pos++]&127)<<t*7)>>>0,e}if(this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(this.buf[this.pos]&127)<<t*7+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw indexOutOfRange(this);if(e.hi=(e.hi|(this.buf[this.pos]&127)<<t*7+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}Reader$1.prototype.bool=function e(){return this.uint32()!==0};function readFixed32_end(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}Reader$1.prototype.fixed32=function e(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return readFixed32_end(this.buf,this.pos+=4)};Reader$1.prototype.sfixed32=function e(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return readFixed32_end(this.buf,this.pos+=4)|0};function readFixed64(){if(this.pos+8>this.len)throw indexOutOfRange(this,8);return new LongBits(readFixed32_end(this.buf,this.pos+=4),readFixed32_end(this.buf,this.pos+=4))}Reader$1.prototype.float=function e(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);var t=util$5.float.readFloatLE(this.buf,this.pos);return this.pos+=4,t};Reader$1.prototype.double=function e(){if(this.pos+8>this.len)throw indexOutOfRange(this,4);var t=util$5.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,t};Reader$1.prototype.bytes=function e(){var t=this.uint32(),r=this.pos,o=this.pos+t;if(o>this.len)throw indexOutOfRange(this,t);if(this.pos+=t,Array.isArray(this.buf))return this.buf.slice(r,o);if(r===o){var l=util$5.Buffer;return l?l.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,r,o)};Reader$1.prototype.string=function e(){var t=this.bytes();return utf8.read(t,0,t.length)};Reader$1.prototype.skip=function e(t){if(typeof t=="number"){if(this.pos+t>this.len)throw indexOutOfRange(this,t);this.pos+=t}else do if(this.pos>=this.len)throw indexOutOfRange(this);while(this.buf[this.pos++]&128);return this};Reader$1.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(e=this.uint32()&7)!==4;)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this};Reader$1._configure=function(e){BufferReader$1=e,Reader$1.create=create(),BufferReader$1._configure();var t=util$5.Long?"toLong":"toNumber";util$5.merge(Reader$1.prototype,{int64:function(){return readLongVarint.call(this)[t](!1)},uint64:function(){return readLongVarint.call(this)[t](!0)},sint64:function(){return readLongVarint.call(this).zzDecode()[t](!1)},fixed64:function(){return readFixed64.call(this)[t](!0)},sfixed64:function(){return readFixed64.call(this)[t](!1)}})};var reader_buffer=BufferReader,Reader=reader;(BufferReader.prototype=Object.create(Reader.prototype)).constructor=BufferReader;var util$4=requireMinimal();function BufferReader(e){Reader.call(this,e)}BufferReader._configure=function(){util$4.Buffer&&(BufferReader.prototype._slice=util$4.Buffer.prototype.slice)};BufferReader.prototype.string=function e(){var t=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+t,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+t,this.len))};BufferReader._configure();var rpc={},service$1=Service$1,util$3=requireMinimal();(Service$1.prototype=Object.create(util$3.EventEmitter.prototype)).constructor=Service$1;function Service$1(e,t,r){if(typeof e!="function")throw TypeError("rpcImpl must be a function");util$3.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=!!t,this.responseDelimited=!!r}Service$1.prototype.rpcCall=function e(t,r,o,l,f){if(!l)throw TypeError("request must be specified");var n=this;if(!f)return util$3.asPromise(e,n,t,r,o,l);if(!n.rpcImpl){setTimeout(function(){f(Error("already ended"))},0);return}try{return n.rpcImpl(t,r[n.requestDelimited?"encodeDelimited":"encode"](l).finish(),function(s,a){if(s)return n.emit("error",s,t),f(s);if(a===null){n.end(!0);return}if(!(a instanceof o))try{a=o[n.responseDelimited?"decodeDelimited":"decode"](a)}catch(d){return n.emit("error",d,t),f(d)}return n.emit("data",a,t),f(null,a)})}catch(u){n.emit("error",u,t),setTimeout(function(){f(u)},0);return}};Service$1.prototype.end=function e(t){return this.rpcImpl&&(t||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this};(function(e){var t=e;t.Service=service$1})(rpc);var roots={};(function(e){var t=e;t.build="minimal",t.Writer=writer,t.BufferWriter=writer_buffer,t.Reader=reader,t.BufferReader=reader_buffer,t.util=requireMinimal(),t.rpc=rpc,t.roots=roots,t.configure=r;function r(){t.util._configure(),t.Writer._configure(t.BufferWriter),t.Reader._configure(t.BufferReader)}r()})(indexMinimal);var util$2={exports:{}},codegen_1,hasRequiredCodegen;function requireCodegen(){if(hasRequiredCodegen)return codegen_1;hasRequiredCodegen=1,codegen_1=e;function e(t,r){typeof t=="string"&&(r=t,t=void 0);var o=[];function l(n){if(typeof n!="string"){var u=f();if(e.verbose&&console.log("codegen: "+u),u="return "+u,n){for(var s=Object.keys(n),a=new Array(s.length+1),d=new Array(s.length),c=0;c<s.length;)a[c]=s[c],d[c]=n[s[c++]];return a[c]=u,Function.apply(null,a).apply(null,d)}return Function(u)()}for(var m=new Array(arguments.length-1),p=0;p<m.length;)m[p]=arguments[++p];if(p=0,n=n.replace(/%([%dfijs])/g,function(y,_){var $=m[p++];switch(_){case"d":case"f":return String(Number($));case"i":return String(Math.floor($));case"j":return JSON.stringify($);case"s":return String($)}return"%"}),p!==m.length)throw Error("parameter count mismatch");return o.push(n),l}function f(n){return"function "+(n||r||"")+"("+(t&&t.join(",")||"")+`){
  `+o.join(`
  `)+`
}`}return l.toString=f,l}return e.verbose=!1,codegen_1}var fetch_1,hasRequiredFetch;function requireFetch(){if(hasRequiredFetch)return fetch_1;hasRequiredFetch=1,fetch_1=o;var e=aspromise,t=inquire_1,r=t("fs");function o(l,f,n){return typeof f=="function"?(n=f,f={}):f||(f={}),n?!f.xhr&&r&&r.readFile?r.readFile(l,function(s,a){return s&&typeof XMLHttpRequest<"u"?o.xhr(l,f,n):s?n(s):n(null,f.binary?a:a.toString("utf8"))}):o.xhr(l,f,n):e(o,this,l,f)}return o.xhr=function(f,n,u){var s=new XMLHttpRequest;s.onreadystatechange=function(){if(s.readyState===4){if(s.status!==0&&s.status!==200)return u(Error("status "+s.status));if(n.binary){var d=s.response;if(!d){d=[];for(var c=0;c<s.responseText.length;++c)d.push(s.responseText.charCodeAt(c)&255)}return u(null,typeof Uint8Array<"u"?new Uint8Array(d):d)}return u(null,s.responseText)}},n.binary&&("overrideMimeType"in s&&s.overrideMimeType("text/plain; charset=x-user-defined"),s.responseType="arraybuffer"),s.open("GET",f),s.send()},fetch_1}var path={},hasRequiredPath;function requirePath(){return hasRequiredPath||(hasRequiredPath=1,function(e){var t=e,r=t.isAbsolute=function(f){return/^(?:\/|\w+:)/.test(f)},o=t.normalize=function(f){f=f.replace(/\\/g,"/").replace(/\/{2,}/g,"/");var n=f.split("/"),u=r(f),s="";u&&(s=n.shift()+"/");for(var a=0;a<n.length;)n[a]===".."?a>0&&n[a-1]!==".."?n.splice(--a,2):u?n.splice(a,1):++a:n[a]==="."?n.splice(a,1):++a;return s+n.join("/")};t.resolve=function(f,n,u){return u||(n=o(n)),r(n)?n:(u||(f=o(f)),(f=f.replace(/(?:\/|^)[^/]+$/,"")).length?o(f+"/"+n):n)}}(path)),path}var types$1={},hasRequiredTypes;function requireTypes(){return hasRequiredTypes||(hasRequiredTypes=1,function(e){var t=e,r=requireUtil(),o=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function l(f,n){var u=0,s={};for(n|=0;u<f.length;)s[o[u+n]]=f[u++];return s}t.basic=l([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]),t.defaults=l([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",r.emptyArray,null]),t.long=l([0,0,0,1,1],7),t.mapKey=l([0,0,0,5,5,0,0,0,1,1,0,2],2),t.packed=l([1,5,0,0,0,5,5,0,0,0,1,1,0])}(types$1)),types$1}var field,hasRequiredField;function requireField(){if(hasRequiredField)return field;hasRequiredField=1,field=n;var e=requireObject();((n.prototype=Object.create(e.prototype)).constructor=n).className="Field";var t=require_enum(),r=requireTypes(),o=requireUtil(),l,f=/^required|optional|repeated$/;n.fromJSON=function(s,a){return new n(s,a.id,a.type,a.rule,a.extend,a.options,a.comment)};function n(u,s,a,d,c,m,p){if(o.isObject(d)?(p=c,m=d,d=c=void 0):o.isObject(c)&&(p=m,m=c,c=void 0),e.call(this,u,m),!o.isInteger(s)||s<0)throw TypeError("id must be a non-negative integer");if(!o.isString(a))throw TypeError("type must be a string");if(d!==void 0&&!f.test(d=d.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(c!==void 0&&!o.isString(c))throw TypeError("extend must be a string");d==="proto3_optional"&&(d="optional"),this.rule=d&&d!=="optional"?d:void 0,this.type=a,this.id=s,this.extend=c||void 0,this.required=d==="required",this.optional=!this.required,this.repeated=d==="repeated",this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=o.Long?r.long[a]!==void 0:!1,this.bytes=a==="bytes",this.resolvedType=null,this.extensionField=null,this.declaringField=null,this._packed=null,this.comment=p}return Object.defineProperty(n.prototype,"packed",{get:function(){return this._packed===null&&(this._packed=this.getOption("packed")!==!1),this._packed}}),n.prototype.setOption=function(s,a,d){return s==="packed"&&(this._packed=null),e.prototype.setOption.call(this,s,a,d)},n.prototype.toJSON=function(s){var a=s?!!s.keepComments:!1;return o.toObject(["rule",this.rule!=="optional"&&this.rule||void 0,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",a?this.comment:void 0])},n.prototype.resolve=function(){if(this.resolved)return this;if((this.typeDefault=r.defaults[this.type])===void 0?(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof l?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]):this.options&&this.options.proto3_optional&&(this.typeDefault=null),this.options&&this.options.default!=null&&(this.typeDefault=this.options.default,this.resolvedType instanceof t&&typeof this.typeDefault=="string"&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&((this.options.packed===!0||this.options.packed!==void 0&&this.resolvedType&&!(this.resolvedType instanceof t))&&delete this.options.packed,Object.keys(this.options).length||(this.options=void 0)),this.long)this.typeDefault=o.Long.fromNumber(this.typeDefault,this.type.charAt(0)==="u"),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&typeof this.typeDefault=="string"){var s;o.base64.test(this.typeDefault)?o.base64.decode(this.typeDefault,s=o.newBuffer(o.base64.length(this.typeDefault)),0):o.utf8.write(this.typeDefault,s=o.newBuffer(o.utf8.length(this.typeDefault)),0),this.typeDefault=s}return this.map?this.defaultValue=o.emptyObject:this.repeated?this.defaultValue=o.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof l&&(this.parent.ctor.prototype[this.name]=this.defaultValue),e.prototype.resolve.call(this)},n.d=function(s,a,d,c){return typeof a=="function"?a=o.decorateType(a).name:a&&typeof a=="object"&&(a=o.decorateEnum(a).name),function(p,v){o.decorateType(p.constructor).add(new n(v,s,a,d,{default:c}))}},n._configure=function(s){l=s},field}var oneof,hasRequiredOneof;function requireOneof(){if(hasRequiredOneof)return oneof;hasRequiredOneof=1,oneof=o;var e=requireObject();((o.prototype=Object.create(e.prototype)).constructor=o).className="OneOf";var t=requireField(),r=requireUtil();function o(f,n,u,s){if(Array.isArray(n)||(u=n,n=void 0),e.call(this,f,u),!(n===void 0||Array.isArray(n)))throw TypeError("fieldNames must be an Array");this.oneof=n||[],this.fieldsArray=[],this.comment=s}o.fromJSON=function(n,u){return new o(n,u.oneof,u.options,u.comment)},o.prototype.toJSON=function(n){var u=n?!!n.keepComments:!1;return r.toObject(["options",this.options,"oneof",this.oneof,"comment",u?this.comment:void 0])};function l(f){if(f.parent)for(var n=0;n<f.fieldsArray.length;++n)f.fieldsArray[n].parent||f.parent.add(f.fieldsArray[n])}return o.prototype.add=function(n){if(!(n instanceof t))throw TypeError("field must be a Field");return n.parent&&n.parent!==this.parent&&n.parent.remove(n),this.oneof.push(n.name),this.fieldsArray.push(n),n.partOf=this,l(this),this},o.prototype.remove=function(n){if(!(n instanceof t))throw TypeError("field must be a Field");var u=this.fieldsArray.indexOf(n);if(u<0)throw Error(n+" is not a member of "+this);return this.fieldsArray.splice(u,1),u=this.oneof.indexOf(n.name),u>-1&&this.oneof.splice(u,1),n.partOf=null,this},o.prototype.onAdd=function(n){e.prototype.onAdd.call(this,n);for(var u=this,s=0;s<this.oneof.length;++s){var a=n.get(this.oneof[s]);a&&!a.partOf&&(a.partOf=u,u.fieldsArray.push(a))}l(this)},o.prototype.onRemove=function(n){for(var u=0,s;u<this.fieldsArray.length;++u)(s=this.fieldsArray[u]).parent&&s.parent.remove(s);e.prototype.onRemove.call(this,n)},o.d=function(){for(var n=new Array(arguments.length),u=0;u<arguments.length;)n[u]=arguments[u++];return function(a,d){r.decorateType(a.constructor).add(new o(d,n)),Object.defineProperty(a,d,{get:r.oneOfGetter(n),set:r.oneOfSetter(n)})}},oneof}var namespace,hasRequiredNamespace;function requireNamespace(){if(hasRequiredNamespace)return namespace;hasRequiredNamespace=1,namespace=s;var e=requireObject();((s.prototype=Object.create(e.prototype)).constructor=s).className="Namespace";var t=requireField(),r=requireUtil(),o=requireOneof(),l,f,n;s.fromJSON=function(c,m){return new s(c,m.options).addJSON(m.nested)};function u(d,c){if(d&&d.length){for(var m={},p=0;p<d.length;++p)m[d[p].name]=d[p].toJSON(c);return m}}s.arrayToJSON=u,s.isReservedId=function(c,m){if(c){for(var p=0;p<c.length;++p)if(typeof c[p]!="string"&&c[p][0]<=m&&c[p][1]>m)return!0}return!1},s.isReservedName=function(c,m){if(c){for(var p=0;p<c.length;++p)if(c[p]===m)return!0}return!1};function s(d,c){e.call(this,d,c),this.nested=void 0,this._nestedArray=null}function a(d){return d._nestedArray=null,d}return Object.defineProperty(s.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=r.toArray(this.nested))}}),s.prototype.toJSON=function(c){return r.toObject(["options",this.options,"nested",u(this.nestedArray,c)])},s.prototype.addJSON=function(c){var m=this;if(c)for(var p=Object.keys(c),v=0,y;v<p.length;++v)y=c[p[v]],m.add((y.fields!==void 0?l.fromJSON:y.values!==void 0?n.fromJSON:y.methods!==void 0?f.fromJSON:y.id!==void 0?t.fromJSON:s.fromJSON)(p[v],y));return this},s.prototype.get=function(c){return this.nested&&this.nested[c]||null},s.prototype.getEnum=function(c){if(this.nested&&this.nested[c]instanceof n)return this.nested[c].values;throw Error("no such enum: "+c)},s.prototype.add=function(c){if(!(c instanceof t&&c.extend!==void 0||c instanceof l||c instanceof o||c instanceof n||c instanceof f||c instanceof s))throw TypeError("object must be a valid nested object");if(!this.nested)this.nested={};else{var m=this.get(c.name);if(m)if(m instanceof s&&c instanceof s&&!(m instanceof l||m instanceof f)){for(var p=m.nestedArray,v=0;v<p.length;++v)c.add(p[v]);this.remove(m),this.nested||(this.nested={}),c.setOptions(m.options,!0)}else throw Error("duplicate name '"+c.name+"' in "+this)}return this.nested[c.name]=c,c.onAdd(this),a(this)},s.prototype.remove=function(c){if(!(c instanceof e))throw TypeError("object must be a ReflectionObject");if(c.parent!==this)throw Error(c+" is not a member of "+this);return delete this.nested[c.name],Object.keys(this.nested).length||(this.nested=void 0),c.onRemove(this),a(this)},s.prototype.define=function(c,m){if(r.isString(c))c=c.split(".");else if(!Array.isArray(c))throw TypeError("illegal path");if(c&&c.length&&c[0]==="")throw Error("path must be relative");for(var p=this;c.length>0;){var v=c.shift();if(p.nested&&p.nested[v]){if(p=p.nested[v],!(p instanceof s))throw Error("path conflicts with non-namespace objects")}else p.add(p=new s(v))}return m&&p.addJSON(m),p},s.prototype.resolveAll=function(){for(var c=this.nestedArray,m=0;m<c.length;)c[m]instanceof s?c[m++].resolveAll():c[m++].resolve();return this.resolve()},s.prototype.lookup=function(c,m,p){if(typeof m=="boolean"?(p=m,m=void 0):m&&!Array.isArray(m)&&(m=[m]),r.isString(c)&&c.length){if(c===".")return this.root;c=c.split(".")}else if(!c.length)return this;if(c[0]==="")return this.root.lookup(c.slice(1),m);var v=this.get(c[0]);if(v){if(c.length===1){if(!m||m.indexOf(v.constructor)>-1)return v}else if(v instanceof s&&(v=v.lookup(c.slice(1),m,!0)))return v}else for(var y=0;y<this.nestedArray.length;++y)if(this._nestedArray[y]instanceof s&&(v=this._nestedArray[y].lookup(c,m,!0)))return v;return this.parent===null||p?null:this.parent.lookup(c,m)},s.prototype.lookupType=function(c){var m=this.lookup(c,[l]);if(!m)throw Error("no such type: "+c);return m},s.prototype.lookupEnum=function(c){var m=this.lookup(c,[n]);if(!m)throw Error("no such Enum '"+c+"' in "+this);return m},s.prototype.lookupTypeOrEnum=function(c){var m=this.lookup(c,[l,n]);if(!m)throw Error("no such Type or Enum '"+c+"' in "+this);return m},s.prototype.lookupService=function(c){var m=this.lookup(c,[f]);if(!m)throw Error("no such Service '"+c+"' in "+this);return m},s._configure=function(d,c,m){l=d,f=c,n=m},namespace}var mapfield,hasRequiredMapfield;function requireMapfield(){if(hasRequiredMapfield)return mapfield;hasRequiredMapfield=1,mapfield=o;var e=requireField();((o.prototype=Object.create(e.prototype)).constructor=o).className="MapField";var t=requireTypes(),r=requireUtil();function o(l,f,n,u,s,a){if(e.call(this,l,f,u,void 0,void 0,s,a),!r.isString(n))throw TypeError("keyType must be a string");this.keyType=n,this.resolvedKeyType=null,this.map=!0}return o.fromJSON=function(f,n){return new o(f,n.id,n.keyType,n.type,n.options,n.comment)},o.prototype.toJSON=function(f){var n=f?!!f.keepComments:!1;return r.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",n?this.comment:void 0])},o.prototype.resolve=function(){if(this.resolved)return this;if(t.mapKey[this.keyType]===void 0)throw Error("invalid key type: "+this.keyType);return e.prototype.resolve.call(this)},o.d=function(f,n,u){return typeof u=="function"?u=r.decorateType(u).name:u&&typeof u=="object"&&(u=r.decorateEnum(u).name),function(a,d){r.decorateType(a.constructor).add(new o(d,f,n,u))}},mapfield}var method,hasRequiredMethod;function requireMethod(){if(hasRequiredMethod)return method;hasRequiredMethod=1,method=r;var e=requireObject();((r.prototype=Object.create(e.prototype)).constructor=r).className="Method";var t=requireUtil();function r(o,l,f,n,u,s,a,d,c){if(t.isObject(u)?(a=u,u=s=void 0):t.isObject(s)&&(a=s,s=void 0),!(l===void 0||t.isString(l)))throw TypeError("type must be a string");if(!t.isString(f))throw TypeError("requestType must be a string");if(!t.isString(n))throw TypeError("responseType must be a string");e.call(this,o,a),this.type=l||"rpc",this.requestType=f,this.requestStream=u?!0:void 0,this.responseType=n,this.responseStream=s?!0:void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=d,this.parsedOptions=c}return r.fromJSON=function(l,f){return new r(l,f.type,f.requestType,f.responseType,f.requestStream,f.responseStream,f.options,f.comment,f.parsedOptions)},r.prototype.toJSON=function(l){var f=l?!!l.keepComments:!1;return t.toObject(["type",this.type!=="rpc"&&this.type||void 0,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",f?this.comment:void 0,"parsedOptions",this.parsedOptions])},r.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),e.prototype.resolve.call(this))},method}var service,hasRequiredService;function requireService(){if(hasRequiredService)return service;hasRequiredService=1,service=l;var e=requireNamespace();((l.prototype=Object.create(e.prototype)).constructor=l).className="Service";var t=requireMethod(),r=requireUtil(),o=rpc;function l(n,u){e.call(this,n,u),this.methods={},this._methodsArray=null}l.fromJSON=function(u,s){var a=new l(u,s.options);if(s.methods)for(var d=Object.keys(s.methods),c=0;c<d.length;++c)a.add(t.fromJSON(d[c],s.methods[d[c]]));return s.nested&&a.addJSON(s.nested),a.comment=s.comment,a},l.prototype.toJSON=function(u){var s=e.prototype.toJSON.call(this,u),a=u?!!u.keepComments:!1;return r.toObject(["options",s&&s.options||void 0,"methods",e.arrayToJSON(this.methodsArray,u)||{},"nested",s&&s.nested||void 0,"comment",a?this.comment:void 0])},Object.defineProperty(l.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=r.toArray(this.methods))}});function f(n){return n._methodsArray=null,n}return l.prototype.get=function(u){return this.methods[u]||e.prototype.get.call(this,u)},l.prototype.resolveAll=function(){for(var u=this.methodsArray,s=0;s<u.length;++s)u[s].resolve();return e.prototype.resolve.call(this)},l.prototype.add=function(u){if(this.get(u.name))throw Error("duplicate name '"+u.name+"' in "+this);return u instanceof t?(this.methods[u.name]=u,u.parent=this,f(this)):e.prototype.add.call(this,u)},l.prototype.remove=function(u){if(u instanceof t){if(this.methods[u.name]!==u)throw Error(u+" is not a member of "+this);return delete this.methods[u.name],u.parent=null,f(this)}return e.prototype.remove.call(this,u)},l.prototype.create=function(u,s,a){for(var d=new o.Service(u,s,a),c=0,m;c<this.methodsArray.length;++c){var p=r.lcFirst((m=this._methodsArray[c]).resolve().name).replace(/[^$\w_]/g,"");d[p]=r.codegen(["r","c"],r.isReserved(p)?p+"_":p)("return this.rpcCall(m,q,s,r,c)")({m,q:m.resolvedRequestType.ctor,s:m.resolvedResponseType.ctor})}return d},service}var message=Message,util$1=requireMinimal();function Message(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}Message.create=function e(t){return this.$type.create(t)};Message.encode=function e(t,r){return this.$type.encode(t,r)};Message.encodeDelimited=function e(t,r){return this.$type.encodeDelimited(t,r)};Message.decode=function e(t){return this.$type.decode(t)};Message.decodeDelimited=function e(t){return this.$type.decodeDelimited(t)};Message.verify=function e(t){return this.$type.verify(t)};Message.fromObject=function e(t){return this.$type.fromObject(t)};Message.toObject=function e(t,r){return this.$type.toObject(t,r)};Message.prototype.toJSON=function e(){return this.$type.toObject(this,util$1.toJSONOptions)};var decoder_1,hasRequiredDecoder;function requireDecoder(){if(hasRequiredDecoder)return decoder_1;hasRequiredDecoder=1,decoder_1=l;var e=require_enum(),t=requireTypes(),r=requireUtil();function o(f){return"missing required '"+f.name+"'"}function l(f){var n=r.codegen(["r","l"],f.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(f.fieldsArray.filter(function(m){return m.map}).length?",k,value":""))("while(r.pos<c){")("var t=r.uint32()");f.group&&n("if((t&7)===4)")("break"),n("switch(t>>>3){");for(var u=0;u<f.fieldsArray.length;++u){var s=f._fieldsArray[u].resolve(),a=s.resolvedType instanceof e?"int32":s.type,d="m"+r.safeProp(s.name);n("case %i: {",s.id),s.map?(n("if(%s===util.emptyObject)",d)("%s={}",d)("var c2 = r.uint32()+r.pos"),t.defaults[s.keyType]!==void 0?n("k=%j",t.defaults[s.keyType]):n("k=null"),t.defaults[a]!==void 0?n("value=%j",t.defaults[a]):n("value=null"),n("while(r.pos<c2){")("var tag2=r.uint32()")("switch(tag2>>>3){")("case 1: k=r.%s(); break",s.keyType)("case 2:"),t.basic[a]===void 0?n("value=types[%i].decode(r,r.uint32())",u):n("value=r.%s()",a),n("break")("default:")("r.skipType(tag2&7)")("break")("}")("}"),t.long[s.keyType]!==void 0?n('%s[typeof k==="object"?util.longToHash(k):k]=value',d):n("%s[k]=value",d)):s.repeated?(n("if(!(%s&&%s.length))",d,d)("%s=[]",d),t.packed[a]!==void 0&&n("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",d,a)("}else"),t.basic[a]===void 0?n(s.resolvedType.group?"%s.push(types[%i].decode(r))":"%s.push(types[%i].decode(r,r.uint32()))",d,u):n("%s.push(r.%s())",d,a)):t.basic[a]===void 0?n(s.resolvedType.group?"%s=types[%i].decode(r)":"%s=types[%i].decode(r,r.uint32())",d,u):n("%s=r.%s()",d,a),n("break")("}")}for(n("default:")("r.skipType(t&7)")("break")("}")("}"),u=0;u<f._fieldsArray.length;++u){var c=f._fieldsArray[u];c.required&&n("if(!m.hasOwnProperty(%j))",c.name)("throw util.ProtocolError(%j,{instance:m})",o(c))}return n("return m")}return decoder_1}var verifier_1,hasRequiredVerifier;function requireVerifier(){if(hasRequiredVerifier)return verifier_1;hasRequiredVerifier=1,verifier_1=f;var e=require_enum(),t=requireUtil();function r(n,u){return n.name+": "+u+(n.repeated&&u!=="array"?"[]":n.map&&u!=="object"?"{k:"+n.keyType+"}":"")+" expected"}function o(n,u,s,a){if(u.resolvedType)if(u.resolvedType instanceof e){n("switch(%s){",a)("default:")("return%j",r(u,"enum value"));for(var d=Object.keys(u.resolvedType.values),c=0;c<d.length;++c)n("case %i:",u.resolvedType.values[d[c]]);n("break")("}")}else n("{")("var e=types[%i].verify(%s);",s,a)("if(e)")("return%j+e",u.name+".")("}");else switch(u.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":n("if(!util.isInteger(%s))",a)("return%j",r(u,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":n("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",a,a,a,a)("return%j",r(u,"integer|Long"));break;case"float":case"double":n('if(typeof %s!=="number")',a)("return%j",r(u,"number"));break;case"bool":n('if(typeof %s!=="boolean")',a)("return%j",r(u,"boolean"));break;case"string":n("if(!util.isString(%s))",a)("return%j",r(u,"string"));break;case"bytes":n('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',a,a,a)("return%j",r(u,"buffer"));break}return n}function l(n,u,s){switch(u.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":n("if(!util.key32Re.test(%s))",s)("return%j",r(u,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":n("if(!util.key64Re.test(%s))",s)("return%j",r(u,"integer|Long key"));break;case"bool":n("if(!util.key2Re.test(%s))",s)("return%j",r(u,"boolean key"));break}return n}function f(n){var u=t.codegen(["m"],n.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),s=n.oneofsArray,a={};s.length&&u("var p={}");for(var d=0;d<n.fieldsArray.length;++d){var c=n._fieldsArray[d].resolve(),m="m"+t.safeProp(c.name);if(c.optional&&u("if(%s!=null&&m.hasOwnProperty(%j)){",m,c.name),c.map)u("if(!util.isObject(%s))",m)("return%j",r(c,"object"))("var k=Object.keys(%s)",m)("for(var i=0;i<k.length;++i){"),l(u,c,"k[i]"),o(u,c,d,m+"[k[i]]")("}");else if(c.repeated)u("if(!Array.isArray(%s))",m)("return%j",r(c,"array"))("for(var i=0;i<%s.length;++i){",m),o(u,c,d,m+"[i]")("}");else{if(c.partOf){var p=t.safeProp(c.partOf.name);a[c.partOf.name]===1&&u("if(p%s===1)",p)("return%j",c.partOf.name+": multiple values"),a[c.partOf.name]=1,u("p%s=1",p)}o(u,c,d,m)}c.optional&&u("}")}return u("return null")}return verifier_1}var converter={},hasRequiredConverter;function requireConverter(){return hasRequiredConverter||(hasRequiredConverter=1,function(e){var t=e,r=require_enum(),o=requireUtil();function l(n,u,s,a){var d=!1;if(u.resolvedType)if(u.resolvedType instanceof r){n("switch(d%s){",a);for(var c=u.resolvedType.values,m=Object.keys(c),p=0;p<m.length;++p)c[m[p]]===u.typeDefault&&!d&&(n("default:")('if(typeof(d%s)==="number"){m%s=d%s;break}',a,a,a),u.repeated||n("break"),d=!0),n("case%j:",m[p])("case %i:",c[m[p]])("m%s=%j",a,c[m[p]])("break");n("}")}else n('if(typeof d%s!=="object")',a)("throw TypeError(%j)",u.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",a,s,a);else{var v=!1;switch(u.type){case"double":case"float":n("m%s=Number(d%s)",a,a);break;case"uint32":case"fixed32":n("m%s=d%s>>>0",a,a);break;case"int32":case"sint32":case"sfixed32":n("m%s=d%s|0",a,a);break;case"uint64":v=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":n("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",a,a,v)('else if(typeof d%s==="string")',a)("m%s=parseInt(d%s,10)",a,a)('else if(typeof d%s==="number")',a)("m%s=d%s",a,a)('else if(typeof d%s==="object")',a)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",a,a,a,v?"true":"");break;case"bytes":n('if(typeof d%s==="string")',a)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",a,a,a)("else if(d%s.length >= 0)",a)("m%s=d%s",a,a);break;case"string":n("m%s=String(d%s)",a,a);break;case"bool":n("m%s=Boolean(d%s)",a,a);break}}return n}t.fromObject=function(u){var s=u.fieldsArray,a=o.codegen(["d"],u.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!s.length)return a("return new this.ctor");a("var m=new this.ctor");for(var d=0;d<s.length;++d){var c=s[d].resolve(),m=o.safeProp(c.name);c.map?(a("if(d%s){",m)('if(typeof d%s!=="object")',m)("throw TypeError(%j)",c.fullName+": object expected")("m%s={}",m)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",m),l(a,c,d,m+"[ks[i]]")("}")("}")):c.repeated?(a("if(d%s){",m)("if(!Array.isArray(d%s))",m)("throw TypeError(%j)",c.fullName+": array expected")("m%s=[]",m)("for(var i=0;i<d%s.length;++i){",m),l(a,c,d,m+"[i]")("}")("}")):(c.resolvedType instanceof r||a("if(d%s!=null){",m),l(a,c,d,m),c.resolvedType instanceof r||a("}"))}return a("return m")};function f(n,u,s,a){if(u.resolvedType)u.resolvedType instanceof r?n("d%s=o.enums===String?(types[%i].values[m%s]===undefined?m%s:types[%i].values[m%s]):m%s",a,s,a,a,s,a,a):n("d%s=types[%i].toObject(m%s,o)",a,s,a);else{var d=!1;switch(u.type){case"double":case"float":n("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",a,a,a,a);break;case"uint64":d=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":n('if(typeof m%s==="number")',a)("d%s=o.longs===String?String(m%s):m%s",a,a,a)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",a,a,a,a,d?"true":"",a);break;case"bytes":n("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",a,a,a,a,a);break;default:n("d%s=m%s",a,a);break}}return n}t.toObject=function(u){var s=u.fieldsArray.slice().sort(o.compareFieldsById);if(!s.length)return o.codegen()("return {}");for(var a=o.codegen(["m","o"],u.name+"$toObject")("if(!o)")("o={}")("var d={}"),d=[],c=[],m=[],p=0;p<s.length;++p)s[p].partOf||(s[p].resolve().repeated?d:s[p].map?c:m).push(s[p]);if(d.length){for(a("if(o.arrays||o.defaults){"),p=0;p<d.length;++p)a("d%s=[]",o.safeProp(d[p].name));a("}")}if(c.length){for(a("if(o.objects||o.defaults){"),p=0;p<c.length;++p)a("d%s={}",o.safeProp(c[p].name));a("}")}if(m.length){for(a("if(o.defaults){"),p=0;p<m.length;++p){var v=m[p],y=o.safeProp(v.name);if(v.resolvedType instanceof r)a("d%s=o.enums===String?%j:%j",y,v.resolvedType.valuesById[v.typeDefault],v.typeDefault);else if(v.long)a("if(util.Long){")("var n=new util.Long(%i,%i,%j)",v.typeDefault.low,v.typeDefault.high,v.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",y)("}else")("d%s=o.longs===String?%j:%i",y,v.typeDefault.toString(),v.typeDefault.toNumber());else if(v.bytes){var _="["+Array.prototype.slice.call(v.typeDefault).join(",")+"]";a("if(o.bytes===String)d%s=%j",y,String.fromCharCode.apply(String,v.typeDefault))("else{")("d%s=%s",y,_)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",y,y)("}")}else a("d%s=%j",y,v.typeDefault)}a("}")}var $=!1;for(p=0;p<s.length;++p){var v=s[p],g=u._fieldsArray.indexOf(v),y=o.safeProp(v.name);v.map?($||($=!0,a("var ks2")),a("if(m%s&&(ks2=Object.keys(m%s)).length){",y,y)("d%s={}",y)("for(var j=0;j<ks2.length;++j){"),f(a,v,g,y+"[ks2[j]]")("}")):v.repeated?(a("if(m%s&&m%s.length){",y,y)("d%s=[]",y)("for(var j=0;j<m%s.length;++j){",y),f(a,v,g,y+"[j]")("}")):(a("if(m%s!=null&&m.hasOwnProperty(%j)){",y,v.name),f(a,v,g,y),v.partOf&&a("if(o.oneofs)")("d%s=%j",o.safeProp(v.partOf.name),v.name)),a("}")}return a("return d")}}(converter)),converter}var wrappers={};(function(e){var t=e,r=message;t[".google.protobuf.Any"]={fromObject:function(o){if(o&&o["@type"]){var l=o["@type"].substring(o["@type"].lastIndexOf("/")+1),f=this.lookup(l);if(f){var n=o["@type"].charAt(0)==="."?o["@type"].slice(1):o["@type"];return n.indexOf("/")===-1&&(n="/"+n),this.create({type_url:n,value:f.encode(f.fromObject(o)).finish()})}}return this.fromObject(o)},toObject:function(o,l){var f="type.googleapis.com/",n="",u="";if(l&&l.json&&o.type_url&&o.value){u=o.type_url.substring(o.type_url.lastIndexOf("/")+1),n=o.type_url.substring(0,o.type_url.lastIndexOf("/")+1);var s=this.lookup(u);s&&(o=s.decode(o.value))}if(!(o instanceof this.ctor)&&o instanceof r){var a=o.$type.toObject(o,l),d=o.$type.fullName[0]==="."?o.$type.fullName.slice(1):o.$type.fullName;return n===""&&(n=f),u=n+d,a["@type"]=u,a}return this.toObject(o,l)}}})(wrappers);var type,hasRequiredType;function requireType(){if(hasRequiredType)return type;hasRequiredType=1,type=y;var e=requireNamespace();((y.prototype=Object.create(e.prototype)).constructor=y).className="Type";var t=require_enum(),r=requireOneof(),o=requireField(),l=requireMapfield(),f=requireService(),n=message,u=reader,s=writer,a=requireUtil(),d=requireEncoder(),c=requireDecoder(),m=requireVerifier(),p=requireConverter(),v=wrappers;function y($,g){e.call(this,$,g),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}Object.defineProperties(y.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var $=Object.keys(this.fields),g=0;g<$.length;++g){var w=this.fields[$[g]],b=w.id;if(this._fieldsById[b])throw Error("duplicate id "+b+" in "+this);this._fieldsById[b]=w}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=a.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=a.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=y.generateConstructor(this)())},set:function($){var g=$.prototype;g instanceof n||(($.prototype=new n).constructor=$,a.merge($.prototype,g)),$.$type=$.prototype.$type=this,a.merge($,n,!0),this._ctor=$;for(var w=0;w<this.fieldsArray.length;++w)this._fieldsArray[w].resolve();var b={};for(w=0;w<this.oneofsArray.length;++w)b[this._oneofsArray[w].resolve().name]={get:a.oneOfGetter(this._oneofsArray[w].oneof),set:a.oneOfSetter(this._oneofsArray[w].oneof)};w&&Object.defineProperties($.prototype,b)}}}),y.generateConstructor=function(g){for(var w=a.codegen(["p"],g.name),b=0,N;b<g.fieldsArray.length;++b)(N=g._fieldsArray[b]).map?w("this%s={}",a.safeProp(N.name)):N.repeated&&w("this%s=[]",a.safeProp(N.name));return w("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")};function _($){return $._fieldsById=$._fieldsArray=$._oneofsArray=null,delete $.encode,delete $.decode,delete $.verify,$}return y.fromJSON=function(g,w){var b=new y(g,w.options);b.extensions=w.extensions,b.reserved=w.reserved;for(var N=Object.keys(w.fields),C=0;C<N.length;++C)b.add((typeof w.fields[N[C]].keyType<"u"?l.fromJSON:o.fromJSON)(N[C],w.fields[N[C]]));if(w.oneofs)for(N=Object.keys(w.oneofs),C=0;C<N.length;++C)b.add(r.fromJSON(N[C],w.oneofs[N[C]]));if(w.nested)for(N=Object.keys(w.nested),C=0;C<N.length;++C){var D=w.nested[N[C]];b.add((D.id!==void 0?o.fromJSON:D.fields!==void 0?y.fromJSON:D.values!==void 0?t.fromJSON:D.methods!==void 0?f.fromJSON:e.fromJSON)(N[C],D))}return w.extensions&&w.extensions.length&&(b.extensions=w.extensions),w.reserved&&w.reserved.length&&(b.reserved=w.reserved),w.group&&(b.group=!0),w.comment&&(b.comment=w.comment),b},y.prototype.toJSON=function(g){var w=e.prototype.toJSON.call(this,g),b=g?!!g.keepComments:!1;return a.toObject(["options",w&&w.options||void 0,"oneofs",e.arrayToJSON(this.oneofsArray,g),"fields",e.arrayToJSON(this.fieldsArray.filter(function(N){return!N.declaringField}),g)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:void 0,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"group",this.group||void 0,"nested",w&&w.nested||void 0,"comment",b?this.comment:void 0])},y.prototype.resolveAll=function(){for(var g=this.fieldsArray,w=0;w<g.length;)g[w++].resolve();var b=this.oneofsArray;for(w=0;w<b.length;)b[w++].resolve();return e.prototype.resolveAll.call(this)},y.prototype.get=function(g){return this.fields[g]||this.oneofs&&this.oneofs[g]||this.nested&&this.nested[g]||null},y.prototype.add=function(g){if(this.get(g.name))throw Error("duplicate name '"+g.name+"' in "+this);if(g instanceof o&&g.extend===void 0){if(this._fieldsById?this._fieldsById[g.id]:this.fieldsById[g.id])throw Error("duplicate id "+g.id+" in "+this);if(this.isReservedId(g.id))throw Error("id "+g.id+" is reserved in "+this);if(this.isReservedName(g.name))throw Error("name '"+g.name+"' is reserved in "+this);return g.parent&&g.parent.remove(g),this.fields[g.name]=g,g.message=this,g.onAdd(this),_(this)}return g instanceof r?(this.oneofs||(this.oneofs={}),this.oneofs[g.name]=g,g.onAdd(this),_(this)):e.prototype.add.call(this,g)},y.prototype.remove=function(g){if(g instanceof o&&g.extend===void 0){if(!this.fields||this.fields[g.name]!==g)throw Error(g+" is not a member of "+this);return delete this.fields[g.name],g.parent=null,g.onRemove(this),_(this)}if(g instanceof r){if(!this.oneofs||this.oneofs[g.name]!==g)throw Error(g+" is not a member of "+this);return delete this.oneofs[g.name],g.parent=null,g.onRemove(this),_(this)}return e.prototype.remove.call(this,g)},y.prototype.isReservedId=function(g){return e.isReservedId(this.reserved,g)},y.prototype.isReservedName=function(g){return e.isReservedName(this.reserved,g)},y.prototype.create=function(g){return new this.ctor(g)},y.prototype.setup=function(){for(var g=this.fullName,w=[],b=0;b<this.fieldsArray.length;++b)w.push(this._fieldsArray[b].resolve().resolvedType);this.encode=d(this)({Writer:s,types:w,util:a}),this.decode=c(this)({Reader:u,types:w,util:a}),this.verify=m(this)({types:w,util:a}),this.fromObject=p.fromObject(this)({types:w,util:a}),this.toObject=p.toObject(this)({types:w,util:a});var N=v[g];if(N){var C=Object.create(this);C.fromObject=this.fromObject,this.fromObject=N.fromObject.bind(C),C.toObject=this.toObject,this.toObject=N.toObject.bind(C)}return this},y.prototype.encode=function(g,w){return this.setup().encode(g,w)},y.prototype.encodeDelimited=function(g,w){return this.encode(g,w&&w.len?w.fork():w).ldelim()},y.prototype.decode=function(g,w){return this.setup().decode(g,w)},y.prototype.decodeDelimited=function(g){return g instanceof u||(g=u.create(g)),this.decode(g,g.uint32())},y.prototype.verify=function(g){return this.setup().verify(g)},y.prototype.fromObject=function(g){return this.setup().fromObject(g)},y.prototype.toObject=function(g,w){return this.setup().toObject(g,w)},y.d=function(g){return function(b){a.decorateType(b,g)}},type}var root,hasRequiredRoot;function requireRoot(){if(hasRequiredRoot)return root;hasRequiredRoot=1,root=s;var e=requireNamespace();((s.prototype=Object.create(e.prototype)).constructor=s).className="Root";var t=requireField(),r=require_enum(),o=requireOneof(),l=requireUtil(),f,n,u;function s(m){e.call(this,"",m),this.deferred=[],this.files=[]}s.fromJSON=function(p,v){return v||(v=new s),p.options&&v.setOptions(p.options),v.addJSON(p.nested)},s.prototype.resolvePath=l.path.resolve,s.prototype.fetch=l.fetch;function a(){}s.prototype.load=function m(p,v,y){typeof v=="function"&&(y=v,v=void 0);var _=this;if(!y)return l.asPromise(m,_,p,v);var $=y===a;function g(x,k){if(y){if($)throw x;var F=y;y=null,F(x,k)}}function w(x){var k=x.lastIndexOf("google/protobuf/");if(k>-1){var F=x.substring(k);if(F in u)return F}return null}function b(x,k){try{if(l.isString(k)&&k.charAt(0)==="{"&&(k=JSON.parse(k)),!l.isString(k))_.setOptions(k.options).addJSON(k.nested);else{n.filename=x;var F=n(k,_,v),L,U=0;if(F.imports)for(;U<F.imports.length;++U)(L=w(F.imports[U])||_.resolvePath(x,F.imports[U]))&&N(L);if(F.weakImports)for(U=0;U<F.weakImports.length;++U)(L=w(F.weakImports[U])||_.resolvePath(x,F.weakImports[U]))&&N(L,!0)}}catch(I){g(I)}!$&&!C&&g(null,_)}function N(x,k){if(x=w(x)||x,!(_.files.indexOf(x)>-1)){if(_.files.push(x),x in u){$?b(x,u[x]):(++C,setTimeout(function(){--C,b(x,u[x])}));return}if($){var F;try{F=l.fs.readFileSync(x).toString("utf8")}catch(L){k||g(L);return}b(x,F)}else++C,_.fetch(x,function(L,U){if(--C,!!y){if(L){k?C||g(null,_):g(L);return}b(x,U)}})}}var C=0;l.isString(p)&&(p=[p]);for(var D=0,q;D<p.length;++D)(q=_.resolvePath("",p[D]))&&N(q);if($)return _;C||g(null,_)},s.prototype.loadSync=function(p,v){if(!l.isNode)throw Error("not supported");return this.load(p,v,a)},s.prototype.resolveAll=function(){if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map(function(p){return"'extend "+p.extend+"' in "+p.parent.fullName}).join(", "));return e.prototype.resolveAll.call(this)};var d=/^[A-Z]/;function c(m,p){var v=p.parent.lookup(p.extend);if(v){var y=new t(p.fullName,p.id,p.type,p.rule,void 0,p.options);return v.get(y.name)||(y.declaringField=p,p.extensionField=y,v.add(y)),!0}return!1}return s.prototype._handleAdd=function(p){if(p instanceof t)p.extend!==void 0&&!p.extensionField&&(c(this,p)||this.deferred.push(p));else if(p instanceof r)d.test(p.name)&&(p.parent[p.name]=p.values);else if(!(p instanceof o)){if(p instanceof f)for(var v=0;v<this.deferred.length;)c(this,this.deferred[v])?this.deferred.splice(v,1):++v;for(var y=0;y<p.nestedArray.length;++y)this._handleAdd(p._nestedArray[y]);d.test(p.name)&&(p.parent[p.name]=p)}},s.prototype._handleRemove=function(p){if(p instanceof t){if(p.extend!==void 0)if(p.extensionField)p.extensionField.parent.remove(p.extensionField),p.extensionField=null;else{var v=this.deferred.indexOf(p);v>-1&&this.deferred.splice(v,1)}}else if(p instanceof r)d.test(p.name)&&delete p.parent[p.name];else if(p instanceof e){for(var y=0;y<p.nestedArray.length;++y)this._handleRemove(p._nestedArray[y]);d.test(p.name)&&delete p.parent[p.name]}},s._configure=function(m,p,v){f=m,n=p,u=v},root}var hasRequiredUtil;function requireUtil(){if(hasRequiredUtil)return util$2.exports;hasRequiredUtil=1;var e=util$2.exports=requireMinimal(),t=roots,r,o;e.codegen=requireCodegen(),e.fetch=requireFetch(),e.path=requirePath(),e.fs=e.inquire("fs"),e.toArray=function(a){if(a){for(var d=Object.keys(a),c=new Array(d.length),m=0;m<d.length;)c[m]=a[d[m++]];return c}return[]},e.toObject=function(a){for(var d={},c=0;c<a.length;){var m=a[c++],p=a[c++];p!==void 0&&(d[m]=p)}return d};var l=/\\/g,f=/"/g;e.isReserved=function(a){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(a)},e.safeProp=function(a){return!/^[$\w_]+$/.test(a)||e.isReserved(a)?'["'+a.replace(l,"\\\\").replace(f,'\\"')+'"]':"."+a},e.ucFirst=function(a){return a.charAt(0).toUpperCase()+a.substring(1)};var n=/_([a-z])/g;e.camelCase=function(a){return a.substring(0,1)+a.substring(1).replace(n,function(d,c){return c.toUpperCase()})},e.compareFieldsById=function(a,d){return a.id-d.id},e.decorateType=function(a,d){if(a.$type)return d&&a.$type.name!==d&&(e.decorateRoot.remove(a.$type),a.$type.name=d,e.decorateRoot.add(a.$type)),a.$type;r||(r=requireType());var c=new r(d||a.name);return e.decorateRoot.add(c),c.ctor=a,Object.defineProperty(a,"$type",{value:c,enumerable:!1}),Object.defineProperty(a.prototype,"$type",{value:c,enumerable:!1}),c};var u=0;return e.decorateEnum=function(a){if(a.$type)return a.$type;o||(o=require_enum());var d=new o("Enum"+u++,a);return e.decorateRoot.add(d),Object.defineProperty(a,"$type",{value:d,enumerable:!1}),d},e.setProperty=function(a,d,c){function m(p,v,y){var _=v.shift();if(_==="__proto__"||_==="prototype")return p;if(v.length>0)p[_]=m(p[_]||{},v,y);else{var $=p[_];$&&(y=[].concat($).concat(y)),p[_]=y}return p}if(typeof a!="object")throw TypeError("dst must be an object");if(!d)throw TypeError("path must be specified");return d=d.split("."),m(a,d,c)},Object.defineProperty(e,"decorateRoot",{get:function(){return t.decorated||(t.decorated=new(requireRoot()))}}),util$2.exports}var object,hasRequiredObject;function requireObject(){if(hasRequiredObject)return object;hasRequiredObject=1,object=r,r.className="ReflectionObject";var e=requireUtil(),t;function r(o,l){if(!e.isString(o))throw TypeError("name must be a string");if(l&&!e.isObject(l))throw TypeError("options must be an object");this.options=l,this.parsedOptions=null,this.name=o,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}return Object.defineProperties(r.prototype,{root:{get:function(){for(var o=this;o.parent!==null;)o=o.parent;return o}},fullName:{get:function(){for(var o=[this.name],l=this.parent;l;)o.unshift(l.name),l=l.parent;return o.join(".")}}}),r.prototype.toJSON=function(){throw Error()},r.prototype.onAdd=function(l){this.parent&&this.parent!==l&&this.parent.remove(this),this.parent=l,this.resolved=!1;var f=l.root;f instanceof t&&f._handleAdd(this)},r.prototype.onRemove=function(l){var f=l.root;f instanceof t&&f._handleRemove(this),this.parent=null,this.resolved=!1},r.prototype.resolve=function(){return this.resolved?this:(this.root instanceof t&&(this.resolved=!0),this)},r.prototype.getOption=function(l){if(this.options)return this.options[l]},r.prototype.setOption=function(l,f,n){return(!n||!this.options||this.options[l]===void 0)&&((this.options||(this.options={}))[l]=f),this},r.prototype.setParsedOption=function(l,f,n){this.parsedOptions||(this.parsedOptions=[]);var u=this.parsedOptions;if(n){var s=u.find(function(c){return Object.prototype.hasOwnProperty.call(c,l)});if(s){var a=s[l];e.setProperty(a,n,f)}else s={},s[l]=e.setProperty({},n,f),u.push(s)}else{var d={};d[l]=f,u.push(d)}return this},r.prototype.setOptions=function(l,f){if(l)for(var n=Object.keys(l),u=0;u<n.length;++u)this.setOption(n[u],l[n[u]],f);return this},r.prototype.toString=function(){var l=this.constructor.className,f=this.fullName;return f.length?l+" "+f:l},r._configure=function(o){t=o},object}var _enum,hasRequired_enum;function require_enum(){if(hasRequired_enum)return _enum;hasRequired_enum=1,_enum=o;var e=requireObject();((o.prototype=Object.create(e.prototype)).constructor=o).className="Enum";var t=requireNamespace(),r=requireUtil();function o(l,f,n,u,s,a){if(e.call(this,l,n),f&&typeof f!="object")throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=u,this.comments=s||{},this.valuesOptions=a,this.reserved=void 0,f)for(var d=Object.keys(f),c=0;c<d.length;++c)typeof f[d[c]]=="number"&&(this.valuesById[this.values[d[c]]=f[d[c]]]=d[c])}return o.fromJSON=function(f,n){var u=new o(f,n.values,n.options,n.comment,n.comments);return u.reserved=n.reserved,u},o.prototype.toJSON=function(f){var n=f?!!f.keepComments:!1;return r.toObject(["options",this.options,"valuesOptions",this.valuesOptions,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"comment",n?this.comment:void 0,"comments",n?this.comments:void 0])},o.prototype.add=function(f,n,u,s){if(!r.isString(f))throw TypeError("name must be a string");if(!r.isInteger(n))throw TypeError("id must be an integer");if(this.values[f]!==void 0)throw Error("duplicate name '"+f+"' in "+this);if(this.isReservedId(n))throw Error("id "+n+" is reserved in "+this);if(this.isReservedName(f))throw Error("name '"+f+"' is reserved in "+this);if(this.valuesById[n]!==void 0){if(!(this.options&&this.options.allow_alias))throw Error("duplicate id "+n+" in "+this);this.values[f]=n}else this.valuesById[this.values[f]=n]=f;return s&&(this.valuesOptions===void 0&&(this.valuesOptions={}),this.valuesOptions[f]=s||null),this.comments[f]=u||null,this},o.prototype.remove=function(f){if(!r.isString(f))throw TypeError("name must be a string");var n=this.values[f];if(n==null)throw Error("name '"+f+"' does not exist in "+this);return delete this.valuesById[n],delete this.values[f],delete this.comments[f],this.valuesOptions&&delete this.valuesOptions[f],this},o.prototype.isReservedId=function(f){return t.isReservedId(this.reserved,f)},o.prototype.isReservedName=function(f){return t.isReservedName(this.reserved,f)},_enum}var encoder_1,hasRequiredEncoder;function requireEncoder(){if(hasRequiredEncoder)return encoder_1;hasRequiredEncoder=1,encoder_1=l;var e=require_enum(),t=requireTypes(),r=requireUtil();function o(f,n,u,s){return n.resolvedType.group?f("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",u,s,(n.id<<3|3)>>>0,(n.id<<3|4)>>>0):f("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",u,s,(n.id<<3|2)>>>0)}function l(f){for(var n=r.codegen(["m","w"],f.name+"$encode")("if(!w)")("w=Writer.create()"),u,s,a=f.fieldsArray.slice().sort(r.compareFieldsById),u=0;u<a.length;++u){var d=a[u].resolve(),c=f._fieldsArray.indexOf(d),m=d.resolvedType instanceof e?"int32":d.type,p=t.basic[m];s="m"+r.safeProp(d.name),d.map?(n("if(%s!=null&&Object.hasOwnProperty.call(m,%j)){",s,d.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",s)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(d.id<<3|2)>>>0,8|t.mapKey[d.keyType],d.keyType),p===void 0?n("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",c,s):n(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|p,m,s),n("}")("}")):d.repeated?(n("if(%s!=null&&%s.length){",s,s),d.packed&&t.packed[m]!==void 0?n("w.uint32(%i).fork()",(d.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",s)("w.%s(%s[i])",m,s)("w.ldelim()"):(n("for(var i=0;i<%s.length;++i)",s),p===void 0?o(n,d,c,s+"[i]"):n("w.uint32(%i).%s(%s[i])",(d.id<<3|p)>>>0,m,s)),n("}")):(d.optional&&n("if(%s!=null&&Object.hasOwnProperty.call(m,%j))",s,d.name),p===void 0?o(n,d,c,s):n("w.uint32(%i).%s(%s)",(d.id<<3|p)>>>0,m,s))}return n("return w")}return encoder_1}var protobuf$1=indexLight.exports=indexMinimal;protobuf$1.build="light";function load(e,t,r){return typeof t=="function"?(r=t,t=new protobuf$1.Root):t||(t=new protobuf$1.Root),t.load(e,r)}protobuf$1.load=load;function loadSync(e,t){return t||(t=new protobuf$1.Root),t.loadSync(e)}protobuf$1.loadSync=loadSync;protobuf$1.encoder=requireEncoder();protobuf$1.decoder=requireDecoder();protobuf$1.verifier=requireVerifier();protobuf$1.converter=requireConverter();protobuf$1.ReflectionObject=requireObject();protobuf$1.Namespace=requireNamespace();protobuf$1.Root=requireRoot();protobuf$1.Enum=require_enum();protobuf$1.Type=requireType();protobuf$1.Field=requireField();protobuf$1.OneOf=requireOneof();protobuf$1.MapField=requireMapfield();protobuf$1.Service=requireService();protobuf$1.Method=requireMethod();protobuf$1.Message=message;protobuf$1.wrappers=wrappers;protobuf$1.types=requireTypes();protobuf$1.util=requireUtil();protobuf$1.ReflectionObject._configure(protobuf$1.Root);protobuf$1.Namespace._configure(protobuf$1.Type,protobuf$1.Service,protobuf$1.Enum);protobuf$1.Root._configure(protobuf$1.Type);protobuf$1.Field._configure(protobuf$1.Type);var indexLightExports=indexLight.exports,tokenize_1=tokenize$1,delimRe=/[\s{}=;:[\],'"()<>]/g,stringDoubleRe=/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,stringSingleRe=/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,setCommentRe=/^ *[*/]+ */,setCommentAltRe=/^\s*\*?\/*/,setCommentSplitRe=/\n/g,whitespaceRe=/\s/,unescapeRe=/\\(.?)/g,unescapeMap={0:"\0",r:"\r",n:`
`,t:"	"};function unescape(e){return e.replace(unescapeRe,function(t,r){switch(r){case"\\":case"":return r;default:return unescapeMap[r]||""}})}tokenize$1.unescape=unescape;function tokenize$1(e,t){e=e.toString();var r=0,o=e.length,l=1,f=0,n={},u=[],s=null;function a(b){return Error("illegal "+b+" (line "+l+")")}function d(){var b=s==="'"?stringSingleRe:stringDoubleRe;b.lastIndex=r-1;var N=b.exec(e);if(!N)throw a("string");return r=b.lastIndex,_(s),s=null,unescape(N[1])}function c(b){return e.charAt(b)}function m(b,N,C){var D={type:e.charAt(b++),lineEmpty:!1,leading:C},q;t?q=2:q=3;var x=b-q,k;do if(--x<0||(k=e.charAt(x))===`
`){D.lineEmpty=!0;break}while(k===" "||k==="	");for(var F=e.substring(b,N).split(setCommentSplitRe),L=0;L<F.length;++L)F[L]=F[L].replace(t?setCommentAltRe:setCommentRe,"").trim();D.text=F.join(`
`).trim(),n[l]=D,f=l}function p(b){var N=v(b),C=e.substring(b,N),D=/^\s*\/\//.test(C);return D}function v(b){for(var N=b;N<o&&c(N)!==`
`;)N++;return N}function y(){if(u.length>0)return u.shift();if(s)return d();var b,N,C,D,q,x=r===0;do{if(r===o)return null;for(b=!1;whitespaceRe.test(C=c(r));)if(C===`
`&&(x=!0,++l),++r===o)return null;if(c(r)==="/"){if(++r===o)throw a("comment");if(c(r)==="/")if(t){if(D=r,q=!1,p(r-1)){q=!0;do if(r=v(r),r===o||(r++,!x))break;while(p(r))}else r=Math.min(o,v(r)+1);q&&(m(D,r,x),x=!0),l++,b=!0}else{for(q=c(D=r+1)==="/";c(++r)!==`
`;)if(r===o)return null;++r,q&&(m(D,r-1,x),x=!0),++l,b=!0}else if((C=c(r))==="*"){D=r+1,q=t||c(D)==="*";do{if(C===`
`&&++l,++r===o)throw a("comment");N=C,C=c(r)}while(N!=="*"||C!=="/");++r,q&&(m(D,r-2,x),x=!0),b=!0}else return"/"}}while(b);var k=r;delimRe.lastIndex=0;var F=delimRe.test(c(k++));if(!F)for(;k<o&&!delimRe.test(c(k));)++k;var L=e.substring(r,r=k);return(L==='"'||L==="'")&&(s=L),L}function _(b){u.push(b)}function $(){if(!u.length){var b=y();if(b===null)return null;_(b)}return u[0]}function g(b,N){var C=$(),D=C===b;if(D)return y(),!0;if(!N)throw a("token '"+C+"', '"+b+"' expected");return!1}function w(b){var N=null,C;return b===void 0?(C=n[l-1],delete n[l-1],C&&(t||C.type==="*"||C.lineEmpty)&&(N=C.leading?C.text:null)):(f<b&&$(),C=n[b],delete n[b],C&&!C.lineEmpty&&(t||C.type==="/")&&(N=C.leading?null:C.text)),N}return Object.defineProperty({next:y,peek:$,push:_,skip:g,cmnt:w},"line",{get:function(){return l}})}var parse_1=parse;parse.filename=null;parse.defaults={keepCase:!1};var tokenize=tokenize_1,Root=requireRoot(),Type=requireType(),Field=requireField(),MapField=requireMapfield(),OneOf=requireOneof(),Enum=require_enum(),Service=requireService(),Method=requireMethod(),types=requireTypes(),util=requireUtil(),base10Re=/^[1-9][0-9]*$/,base10NegRe=/^-?[1-9][0-9]*$/,base16Re=/^0[x][0-9a-fA-F]+$/,base16NegRe=/^-?0[x][0-9a-fA-F]+$/,base8Re=/^0[0-7]+$/,base8NegRe=/^-?0[0-7]+$/,numberRe=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/,nameRe=/^[a-zA-Z_][a-zA-Z_0-9]*$/,typeRefRe=/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)(?:\.[a-zA-Z_][a-zA-Z_0-9]*)*$/,fqTypeRefRe=/^(?:\.[a-zA-Z_][a-zA-Z_0-9]*)+$/;function parse(e,t,r){t instanceof Root||(r=t,t=new Root),r||(r=parse.defaults);var o=r.preferTrailingComment||!1,l=tokenize(e,r.alternateCommentMode||!1),f=l.next,n=l.push,u=l.peek,s=l.skip,a=l.cmnt,d=!0,c,m,p,v,y=!1,_=t,$=r.keepCase?function(R){return R}:util.camelCase;function g(R,E,T){var S=parse.filename;return T||(parse.filename=null),Error("illegal "+(E||"token")+" '"+R+"' ("+(S?S+", ":"")+"line "+l.line+")")}function w(){var R=[],E;do{if((E=f())!=='"'&&E!=="'")throw g(E);R.push(f()),s(E),E=u()}while(E==='"'||E==="'");return R.join("")}function b(R){var E=f();switch(E){case"'":case'"':return n(E),w();case"true":case"TRUE":return!0;case"false":case"FALSE":return!1}try{return C(E,!0)}catch{if(typeRefRe.test(E))return E;throw g(E,"value")}}function N(R,E){var T,S;do E&&((T=u())==='"'||T==="'")?R.push(w()):R.push([S=D(f()),s("to",!0)?D(f()):S]);while(s(",",!0));var A={options:void 0};A.setOption=function(O,B){this.options===void 0&&(this.options={}),this.options[O]=B},L(A,function(B){if(B==="option")H(A,B),s(";");else throw g(B)},function(){G(A)})}function C(R,E){var T=1;switch(R.charAt(0)==="-"&&(T=-1,R=R.substring(1)),R){case"inf":case"INF":case"Inf":return T*(1/0);case"nan":case"NAN":case"Nan":case"NaN":return NaN;case"0":return 0}if(base10Re.test(R))return T*parseInt(R,10);if(base16Re.test(R))return T*parseInt(R,16);if(base8Re.test(R))return T*parseInt(R,8);if(numberRe.test(R))return T*parseFloat(R);throw g(R,"number",E)}function D(R,E){switch(R){case"max":case"MAX":case"Max":return 536870911;case"0":return 0}if(!E&&R.charAt(0)==="-")throw g(R,"id");if(base10NegRe.test(R))return parseInt(R,10);if(base16NegRe.test(R))return parseInt(R,16);if(base8NegRe.test(R))return parseInt(R,8);throw g(R,"id")}function q(){if(c!==void 0)throw g("package");if(c=f(),!typeRefRe.test(c))throw g(c,"name");_=_.define(c),s(";")}function x(){var R=u(),E;switch(R){case"weak":E=p||(p=[]),f();break;case"public":f();default:E=m||(m=[]);break}R=w(),s(";"),E.push(R)}function k(){if(s("="),v=w(),y=v==="proto3",!y&&v!=="proto2")throw g(v,"syntax");t.setOption("syntax",v),s(";")}function F(R,E){switch(E){case"option":return H(R,E),s(";"),!0;case"message":return U(R,E),!0;case"enum":return z(R,E),!0;case"service":return te(R,E),!0;case"extend":return ie(R,E),!0}return!1}function L(R,E,T){var S=l.line;if(R&&(typeof R.comment!="string"&&(R.comment=a()),R.filename=parse.filename),s("{",!0)){for(var A;(A=f())!=="}";)E(A);s(";",!0)}else T&&T(),s(";"),R&&(typeof R.comment!="string"||o)&&(R.comment=a(S)||R.comment)}function U(R,E){if(!nameRe.test(E=f()))throw g(E,"type name");var T=new Type(E);L(T,function(A){if(!F(T,A))switch(A){case"map":Z(T);break;case"required":case"repeated":I(T,A);break;case"optional":y?I(T,"proto3_optional"):I(T,"optional");break;case"oneof":X(T,A);break;case"extensions":N(T.extensions||(T.extensions=[]));break;case"reserved":N(T.reserved||(T.reserved=[]),!0);break;default:if(!y||!typeRefRe.test(A))throw g(A);n(A),I(T,"optional");break}}),R.add(T)}function I(R,E,T){var S=f();if(S==="group"){Y(R,E);return}for(;S.endsWith(".")||u().startsWith(".");)S+=f();if(!typeRefRe.test(S))throw g(S,"type");var A=f();if(!nameRe.test(A))throw g(A,"name");A=$(A),s("=");var O=new Field(A,D(f()),S,E,T);if(L(O,function(M){if(M==="option")H(O,M),s(";");else throw g(M)},function(){G(O)}),E==="proto3_optional"){var B=new OneOf("_"+A);O.setOption("proto3_optional",!0),B.add(O),R.add(B)}else R.add(O);!y&&O.repeated&&(types.packed[S]!==void 0||types.basic[S]===void 0)&&O.setOption("packed",!1,!0)}function Y(R,E){var T=f();if(!nameRe.test(T))throw g(T,"name");var S=util.lcFirst(T);T===S&&(T=util.ucFirst(T)),s("=");var A=D(f()),O=new Type(T);O.group=!0;var B=new Field(S,A,T,E);B.filename=parse.filename,L(O,function(M){switch(M){case"option":H(O,M),s(";");break;case"required":case"repeated":I(O,M);break;case"optional":y?I(O,"proto3_optional"):I(O,"optional");break;case"message":U(O,M);break;case"enum":z(O,M);break;default:throw g(M)}}),R.add(O).add(B)}function Z(R){s("<");var E=f();if(types.mapKey[E]===void 0)throw g(E,"type");s(",");var T=f();if(!typeRefRe.test(T))throw g(T,"type");s(">");var S=f();if(!nameRe.test(S))throw g(S,"name");s("=");var A=new MapField($(S),D(f()),E,T);L(A,function(B){if(B==="option")H(A,B),s(";");else throw g(B)},function(){G(A)}),R.add(A)}function X(R,E){if(!nameRe.test(E=f()))throw g(E,"name");var T=new OneOf($(E));L(T,function(A){A==="option"?(H(T,A),s(";")):(n(A),I(T,"optional"))}),R.add(T)}function z(R,E){if(!nameRe.test(E=f()))throw g(E,"name");var T=new Enum(E);L(T,function(A){switch(A){case"option":H(T,A),s(";");break;case"reserved":N(T.reserved||(T.reserved=[]),!0);break;default:Q(T,A)}}),R.add(T)}function Q(R,E){if(!nameRe.test(E))throw g(E,"name");s("=");var T=D(f(),!0),S={options:void 0};S.setOption=function(A,O){this.options===void 0&&(this.options={}),this.options[A]=O},L(S,function(O){if(O==="option")H(S,O),s(";");else throw g(O)},function(){G(S)}),R.add(E,T,S.comment,S.options)}function H(R,E){var T=s("(",!0);if(!typeRefRe.test(E=f()))throw g(E,"name");var S=E,A=S,O;T&&(s(")"),S="("+S+")",A=S,E=u(),fqTypeRefRe.test(E)&&(O=E.slice(1),S+=E,f())),s("=");var B=K(R,S);ee(R,A,B,O)}function K(R,E){if(s("{",!0)){for(var T={};!s("}",!0);){if(!nameRe.test(P=f()))throw g(P,"name");if(P===null)throw g(P,"end of input");var S,A=P;if(s(":",!0),u()==="{")S=K(R,E+"."+P);else if(u()==="["){S=[];var O;if(s("[",!0)){do O=b(),S.push(O);while(s(",",!0));s("]"),typeof O<"u"&&j(R,E+"."+P,O)}}else S=b(),j(R,E+"."+P,S);var B=T[A];B&&(S=[].concat(B).concat(S)),T[A]=S,s(",",!0),s(";",!0)}return T}var W=b();return j(R,E,W),W}function j(R,E,T){R.setOption&&R.setOption(E,T)}function ee(R,E,T,S){R.setParsedOption&&R.setParsedOption(E,T,S)}function G(R){if(s("[",!0)){do H(R,"option");while(s(",",!0));s("]")}return R}function te(R,E){if(!nameRe.test(E=f()))throw g(E,"service name");var T=new Service(E);L(T,function(A){if(!F(T,A))if(A==="rpc")re(T,A);else throw g(A)}),R.add(T)}function re(R,E){var T=a(),S=E;if(!nameRe.test(E=f()))throw g(E,"name");var A=E,O,B,W,M;if(s("("),s("stream",!0)&&(B=!0),!typeRefRe.test(E=f())||(O=E,s(")"),s("returns"),s("("),s("stream",!0)&&(M=!0),!typeRefRe.test(E=f())))throw g(E);W=E,s(")");var V=new Method(A,S,O,W,B,M);V.comment=T,L(V,function(J){if(J==="option")H(V,J),s(";");else throw g(J)}),R.add(V)}function ie(R,E){if(!typeRefRe.test(E=f()))throw g(E,"reference");var T=E;L(null,function(A){switch(A){case"required":case"repeated":I(R,A,T);break;case"optional":y?I(R,"proto3_optional",T):I(R,"optional",T);break;default:if(!y||!typeRefRe.test(A))throw g(A);n(A),I(R,"optional",T);break}})}for(var P;(P=f())!==null;)switch(P){case"package":if(!d)throw g(P);q();break;case"import":if(!d)throw g(P);x();break;case"syntax":if(!d)throw g(P);k();break;case"option":H(_,P),s(";");break;default:if(F(_,P)){d=!1;continue}throw g(P)}return parse.filename=null,{package:c,imports:m,weakImports:p,syntax:v,root:t}}var common_1=common,commonRe=/\/|\./;function common(e,t){commonRe.test(e)||(e="google/protobuf/"+e+".proto",t={nested:{google:{nested:{protobuf:{nested:t}}}}}),common[e]=t}common("any",{Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}}});var timeType;common("duration",{Duration:timeType={fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}}});common("timestamp",{Timestamp:timeType});common("empty",{Empty:{fields:{}}});common("struct",{Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}}});common("wrappers",{DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}}});common("field_mask",{FieldMask:{fields:{paths:{rule:"repeated",type:"string",id:1}}}});common.get=function e(t){return common[t]||null};var protobuf=src.exports=indexLightExports;protobuf.build="full";protobuf.tokenize=tokenize_1;protobuf.parse=parse_1;protobuf.common=common_1;protobuf.Root._configure(protobuf.Type,protobuf.parse,protobuf.common);var srcExports=src.exports,protobufjs=srcExports;const DataProtoSelphi=`
    syntax = "proto3";

    message AdvTrackingMessage {

        message Config {
            string system = 1;
            string platform = 2;
            string widgetVersion = 3;
            double facePitchThLow = 4;
            double facePitchThHigh = 5;
            double faceYawThLow = 6;
            double faceYawThHigh = 7;
            double iqaOverExposureThHigh = 8;
            double iqaUnderExposureThHigh = 9;
            double iqaSharpnessThLow = 10;
            double iqaReadabilityThLow = 11;
            string livenessMode = 12;
            string scanMode = 13;
            string scanParam = 14;
            string documentType = 15;
            string documentSide = 16;
            bool wizardMode = 17;
        }

        message EventBeginPhase {
            string name = 1;
        }

        message EventEndPhase {
            string name = 1;
        }

        message EventTimeout {
            string message = 1;
        }
    
        message EventError {
            string errorType = 1;
            string message = 2;
        }

        message EventClick {
            string element = 1;
        }

        message EventSwipe {
            string direction = 1;
        }

        message EventFaceFrameCaptured {
            uint32 faceX = 1;
            uint32 faceY = 2;
            uint32 faceW = 3;
            uint32 faceH = 4;
            bool faceFramed = 5;
            uint32 leftEyeX = 6;
            uint32 leftEyeY = 7;
            uint32 rightEyeX = 8;
            uint32 rightEyeY = 9;
            double facePitch = 10;
            bool facePitchInRange = 11;
            double faceYaw = 12;
            bool faceYawInRange = 13;
            double facialScore = 14;
            string stabilizationDiagnostic = 15;
            string extractionDiagnostic = 16;
            bool sunglasses = 17;
        }

        message EventDocumentFrameCaptured {
            string diagnostic = 1;
            double iqaOverExposure = 2;
            bool iqaOverExposureInRange = 3;
            double iqaUnderExposure = 4;
            bool iqaUnderExposureInRange = 5;
            double iqaSharpness = 6;
            bool iqaSharpnessInRange = 7;
            double iqaReadability = 8;
            bool iqaReadabilityInRange = 9;
            string documentClass = 10;
            string documentCaptured = 11;
            uint32 ocrFields = 12;
            uint32 imgFields = 13;
            bool morePagesAvailable = 14;
        }

        message Event {
            string type = 1;
            uint64 time = 2;
            uint32 duration = 3;
            oneof EventData {
                EventBeginPhase beginPhaseData = 4;
                EventEndPhase endPhaseData = 5;
                EventFaceFrameCaptured faceFrameCapturedData = 6;
                EventDocumentFrameCaptured documentFrameCapturedData = 7;
                EventTimeout timeoutData = 8;
                EventError errorData = 9;
                EventClick clickData = 10;
                EventSwipe swipeData = 11;
            }
        }

        message MessageData {
            string version = 1;
            Config config = 2;
            repeated Event events = 3;
        }

        string type = 1;
        string id = 2;
        uint64 time = 3;
        MessageData data = 4;
    }
`;var AdvancedTrackingType;(function(e){e.SelphiExecutionCompleted="selphi.ExecutionCompleted.v1",e.SelphidExecutionCompleted="selphid.ExecutionCompleted.v1"})(AdvancedTrackingType||(AdvancedTrackingType={}));var DataEventType;(function(e){e.beginPhaseData=".beginPhase.v1",e.endPhaseData=".endPhase.v1",e.faceFrameCapturedData=".faceFrameCaptured.v1",e.documentFrameCapturedData=".documentFrameCaptured.v1",e.clickData=".click.v1",e.swipeData=".swipe.v1",e.errorData=".error.v1",e.timeoutData=".timeout.v1"})(DataEventType||(DataEventType={}));var SelphiPhaseNames;(function(e){e.Extraction="extraction",e.Stabilization="stabilization",e.ShowResultsFace="showResultsFace",e.Tutorial="tutorial",e.ShowError="showError",e.ShowTimeout="showTimeout"})(SelphiPhaseNames||(SelphiPhaseNames={}));var SelphidPhaseNames;(function(e){e.CaptureFront="captureFront",e.CaptureBack="captureBack",e.ShowResultsFront="showResultsFront",e.ShowResultsBack="showResultsBack",e.Tutorial="tutorial",e.ShowError="showError",e.ShowTimeout="showTimeout"})(SelphidPhaseNames||(SelphidPhaseNames={}));var ClickableEventElements;(function(e){e.buttonStart="buttonStart",e.buttonConfirm="buttonConfirm",e.buttonContinue="buttonContinue",e.buttonRetry="buttonRetry",e.buttonClose="buttonClose",e.buttonSwitchCamera="buttonSwitchCamera",e.buttonErrorRepeat="buttonErrorRepeat",e.buttonOpenTutorial="buttonOpenTutorial",e.buttonCloseTutorial="buttonCloseTutorial",e.buttonChangeTutorialAnimation="buttonChangeTutorialAnimation",e.buttonToggleSpeech="buttonToggleSpeech"})(ClickableEventElements||(ClickableEventElements={}));class AdvancedTrackingModule{constructor(){this.data={},this.currentTrackingVersion="0.1.0",this.widgetName=null,this.platform="web"}initialize(t,r,o,l,f){this.widgetName=t;const n={system:window.navigator.userAgent,platform:this.platform,widgetVersion:o};l.facePitchThLow&&(n.facePitchThLow=l.facePitchThLow),l.facePitchThHigh&&(n.facePitchThHigh=l.facePitchThHigh),l.faceYawThLow&&(n.faceYawThLow=l.faceYawThLow),l.faceYawThHigh&&(n.faceYawThHigh=l.faceYawThHigh),l.iqaOverExposureThHigh&&(n.iqaOverExposureThHigh=l.iqaOverExposureThHigh),l.iqaUnderExposureThHigh&&(n.iqaUnderExposureThHigh=l.iqaUnderExposureThHigh),l.iqaSharpnessThLow&&(n.iqaSharpnessThLow=l.iqaSharpnessThLow),l.iqaReadabilityThLow&&(n.iqaReadabilityThLow=l.iqaReadabilityThLow),f.livenessMode&&(n.livenessMode=f.livenessMode),f.scanMode&&(n.scanMode=f.scanMode),f.scanParam&&(n.scanParam=f.scanParam),f.documentType&&(n.documentType=f.documentType),f.documentSide&&(n.documentSide=f.documentSide),(f.wizardMode!==null||f.wizardMode!==void 0)&&(n.wizardMode=f.wizardMode),this.data={type:r,id:v4(),time:Date.now(),data:{version:this.currentTrackingVersion,config:n,events:[]}}}addEvent(t,r,o,l){var f;if(!((f=this.data)===null||f===void 0)&&f.data){const n=this.data.data.events;if(n){const u={time:r,type:`${this.widgetName}${t}`};l&&(u.duration=l);const s=Object.entries(DataEventType);for(const[a,d]of s)d===t&&(u[a]=o);n.push(u)}}}getData(){return this.data}async getBuffer(t){return new Promise((r,o)=>{try{const l=`data:text/plain;base64,${btoa(DataProtoSelphi)}`;protobufjs.load(l,(f,n)=>{if(f)throw f;if(n){const u=n.lookupType("AdvTrackingMessage"),s=u.verify(this.data);if(s)throw Error(s);const a=u.create(this.data),d=u.encode(a).finish();if(t){const c=u.decode(d).toJSON();console.log(c)}r(d)}})}catch(l){o(new Error(`Proto buffer could not be generated: ${l}`))}})}async finalize(){this.data=null,this.widgetName=null}}const appendToMap=(e,t,r)=>{const o=e.get(t);o?o.includes(r)||o.push(r):e.set(t,[r])},debounce=(e,t)=>{let r;return(...o)=>{r&&clearTimeout(r),r=setTimeout(()=>{r=0,e(...o)},t)}},isConnected=e=>!("isConnected"in e)||e.isConnected,cleanupElements=debounce(e=>{for(let t of e.keys())e.set(t,e.get(t).filter(isConnected))},2e3),stencilSubscription=()=>{if(typeof getRenderingRef!="function")return{};const e=new Map;return{dispose:()=>e.clear(),get:t=>{const r=getRenderingRef();r&&appendToMap(e,t,r)},set:t=>{const r=e.get(t);r&&e.set(t,r.filter(forceUpdate)),cleanupElements(e)},reset:()=>{e.forEach(t=>t.forEach(forceUpdate)),cleanupElements(e)}}},unwrap=e=>typeof e=="function"?e():e,createObservableMap=(e,t=(r,o)=>r!==o)=>{const r=unwrap(e);let o=new Map(Object.entries(r??{}));const l={dispose:[],get:[],set:[],reset:[]},f=()=>{var v;o=new Map(Object.entries((v=unwrap(e))!==null&&v!==void 0?v:{})),l.reset.forEach(y=>y())},n=()=>{l.dispose.forEach(v=>v()),f()},u=v=>(l.get.forEach(y=>y(v)),o.get(v)),s=(v,y)=>{const _=o.get(v);t(y,_,v)&&(o.set(v,y),l.set.forEach($=>$(v,y,_)))},a=typeof Proxy>"u"?{}:new Proxy(r,{get(v,y){return u(y)},ownKeys(v){return Array.from(o.keys())},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}},has(v,y){return o.has(y)},set(v,y,_){return s(y,_),!0}}),d=(v,y)=>(l[v].push(y),()=>{removeFromArray(l[v],y)});return{state:a,get:u,set:s,on:d,onChange:(v,y)=>{const _=d("set",(g,w)=>{g===v&&y(w)}),$=d("reset",()=>y(unwrap(e)[v]));return()=>{_(),$()}},use:(...v)=>{const y=v.reduce((_,$)=>($.set&&_.push(d("set",$.set)),$.get&&_.push(d("get",$.get)),$.reset&&_.push(d("reset",$.reset)),$.dispose&&_.push(d("dispose",$.dispose)),_),[]);return()=>y.forEach(_=>_())},dispose:n,reset:f,forceUpdate:v=>{const y=o.get(v);l.set.forEach(_=>_(v,y,y))}}},removeFromArray=(e,t)=>{const r=e.indexOf(t);r>=0&&(e[r]=e[e.length-1],e.length--)},createStore=(e,t)=>{const r=createObservableMap(e,t);return r.use(stencilSubscription()),r},{state:config_store,reset:reset_config_store}=createStore(WIDGET_CONFIG),ERROR_STORE_VALUES={type:"",message:""},{state:error_store,reset:reset_error_store}=createStore(ERROR_STORE_VALUES),InternalStoreValues={languageLoaded:!1,customLanguage:null},{state:internal_store,reset:reset_internal_store}=createStore(InternalStoreValues),ExtractionResult={OK:0,NOT_EVALUATED:1,BAD_ANGLE:2,TOO_FAR:3,TOO_CLOSE:4,OUT_OF_BOUNDS:5,BAD_ASPECT_RATIO:6,DOCUMENT_NOT_FOUND:7,FACE_NOT_FOUND:8,MRZ_NOT_FOUND:9,ATTRIBUTES_NOT_FOUND:10,UNDEREXPOSED:11,OVEREXPOSED:12,BLURRED:13,INSUFFICIENT_SAMPLES:14,INSUFFICIENT_TIME:15,TOO_DELAYED:16,TOO_MOVEMENT:17,FREEZED_DOCUMENT:18,TOO_MUCH_ROLL:19,TOO_SMALL:20,STAGE_OK:21,UNCERTAIN:22},ExtractionResultStr={0:"OK",1:"NOT_EVALUATED",2:"BAD_ANGLE",3:"TOO_FAR",4:"TOO_CLOSE",5:"OUT_OF_BOUNDS",6:"BAD_ASPECT_RATIO",7:"DOCUMENT_NOT_FOUND",8:"FACE_NOT_FOUND",9:"MRZ_NOT_FOUND",10:"ATTRIBUTES_NOT_FOUND",11:"UNDEREXPOSED",12:"OVEREXPOSED",13:"BLURRED",14:"INSUFFICIENT_SAMPLES",15:"INSUFFICIENT_TIME",16:"TOO_DELAYED",17:"TOO_MOVEMENT",18:"FREEZED_DOCUMENT",19:"TOO_MUCH_ROLL",20:"TOO_SMALL",21:"STAGE_OK",22:"UNCERTAIN"},IQA_OVER_EXPOSURE_TH_HIGH=88.8,IQA_UNDER_EXPOSURE_TH_HIGH=63,IQA_SHARPNESS_TH_LOW=64.5,IQA_READABILITY_TH_LOW=31;var DiagnosticStatus;(function(e){e.Ok="OK",e.Uncertain="UNCERTAIN",e.DocumentNotDetected="DOCUMENT_NOT_DETECTED"})(DiagnosticStatus||(DiagnosticStatus={}));var DocumentTypeReader;(function(e){e[e.IDC=2]="IDC",e[e.PSP=3]="PSP",e[e.DLI=6]="DLI",e[e.RID=7]="RID"})(DocumentTypeReader||(DocumentTypeReader={}));const DocumentReaderResetMode={FULL_RESET:0,STEP_BACK_RESET:-1};var LoggerLevel;(function(e){e[e.DEBUG=0]="DEBUG",e[e.INFO=1]="INFO",e[e.WARNING=2]="WARNING",e[e.ERROR=3]="ERROR"})(LoggerLevel||(LoggerLevel={}));var StyleLogs;(function(e){e.DEBUG="color: white; background-color: grey; border-radius: 8px; padding: 2px 4px",e.INFO="color: black; background-color: lightblue; border-radius: 8px; padding: 2px 4px",e.WARNING="color: black; background-color: yellow; border-radius: 8px; padding: 2px 4px",e.ERROR="color: white; background-color: red; border-radius: 8px; padding: 2px 4px",e.PRODUCT="color: white; background-color: blueviolet; border-radius: 8px; padding: 2px 4px"})(StyleLogs||(StyleLogs={}));class Logger{static printDebug(t,...r){if(LoggerLevel.DEBUG>=Logger.currentLoggingLevel){let o=`%cdebug%c %c${Logger.loggerTag} ${t}%c

`;const l=r.map(n=>typeof n=="object"&&n!==null?Logger.isDebug?n:JSON.stringify(n,null,2):n);o+=l.filter(n=>typeof n=="string").join(" ");const f=[StyleLogs.DEBUG,"color: inherit;",StyleLogs.PRODUCT,"color: inherit;"];Logger.isDebug?(console.groupCollapsed(o,...f,...l.filter(n=>typeof n=="object")),console.trace(),console.groupEnd()):console.debug(o,...f)}}static printInfo(t,...r){LoggerLevel.INFO>=Logger.currentLoggingLevel&&console.info(`%cinfo%c %c${Logger.loggerTag} ${t}%c

 ${r}`,StyleLogs.INFO,"color: inherit;",StyleLogs.PRODUCT,"color: inherit;")}static printWarning(t,...r){LoggerLevel.WARNING>=Logger.currentLoggingLevel&&console.warn(`%cwarn%c %c${Logger.loggerTag} ${t}%c

 ${r}`,StyleLogs.WARNING,"color: inherit;",StyleLogs.PRODUCT,"color: inherit;")}static printError(t,...r){LoggerLevel.ERROR>=Logger.currentLoggingLevel&&console.error(`%cerror%c %c${Logger.loggerTag} ${t}%c

 ${r}`,StyleLogs.ERROR,"color: inherit;",StyleLogs.PRODUCT,"color: inherit;")}static setLoggerLevel(t){Logger.currentLoggingLevel=t}static setLoggerTag(t){Logger.loggerTag=t}static setDebugMode(t){Logger.isDebug=t}}Logger.loggerTag="";Logger.currentLoggingLevel=LoggerLevel.WARNING;Logger.isDebug=!1;class CameraHardwareError extends Error{constructor(t="We cannot access the camera. Please try with another device."){super(t),this.name="CameraHardwareError"}}class CameraPermissionDenied extends Error{constructor(t="To capture the images we need you to activate this permission."){super(t),this.name="CameraPermissionDenied"}}class MicrophonePermissionDenied extends Error{constructor(t="To capture the video with audio, we need you to activate this permissions."){super(t),this.name="MicrophonePermissionDenied"}}class CameraApiNoAvailableError extends Error{constructor(t="Media Devices not Available, please check if using a Secure Context and try again or use another compatible device."){super(t),this.name="CameraApiNoAvailableError"}}const cameraFilter=[String.fromCharCode.apply(null,[86,73,82,84,85,65,76]),String.fromCharCode.apply(null,[79,66,83]),String.fromCharCode.apply(null,[83,80,76,73,84,67,65,77]),String.fromCharCode.apply(null,[70,65,75,69]),String.fromCharCode.apply(null,[83,78,65,80]),String.fromCharCode.apply(null,[68,69,70,65,85,76,84]),String.fromCharCode.apply(null,[77,79,67,75]),String.fromCharCode.apply(null,[46,89,52,77]),String.fromCharCode.apply(null,[46,77,74,80,69,71])];var FacingMode;(function(e){e.ANY="any",e.USER="user",e.ENVIRONMENT="environment"})(FacingMode||(FacingMode={}));var FocusMode;(function(e){e.CONTINUOUS="continuous"})(FocusMode||(FocusMode={}));var WidgetName;(function(e){e.SELPHI="selphi",e.SELPHID="selphid"})(WidgetName||(WidgetName={}));var CAMERATYPE;(function(e){e[e.User=0]="User",e[e.Environment=1]="Environment"})(CAMERATYPE||(CAMERATYPE={}));function createCameraOrderingMessage(e,t,r,o,l){var f;const n=typeof e=="string"&&e||(e==null?void 0:e[0])||"",u=typeof t.facingMode=="string"&&t.facingMode||((f=t.facingMode)===null||f===void 0?void 0:f[0])||"";return`
            ${o}-${l?"Accepted":"Ignored"} ${n} camera with name: ${r.label}, 
            id: ${t.deviceId||"-"}, 
            focusDiscance: ${t.focusDistance||"-"}, 
            facingMode: ${u||"-"}
        `}class CameraModule{static async getAvailableCameras(){if("mediaDevices"in navigator&&typeof navigator.mediaDevices.enumerateDevices<"u"&&typeof navigator.mediaDevices.getUserMedia<"u"){let t=[];try{if(t=(await navigator.mediaDevices.enumerateDevices()).filter(o=>o.kind==="videoinput"&&!CameraModule.filterFraudCamera(o)),t.length>0)return t;throw new CameraHardwareError("Your device does not pass the minimum requeriments to launch the authentication process, no valid cameras detected within the used device.")}catch(r){throw new Error(`There was an error getting device media resources, ${r}`)}}else throw new CameraApiNoAvailableError}static async sortCameras(t,r,o){var l;const f=[],n=[],u=[],s=[];for(const{deviceId:d}of t)try{const c=await CameraModule.getUserMedia({video:{deviceId:d}}),m=c==null?void 0:c.getVideoTracks()[0];if(m&&(typeof m.getCapabilities=="function"||typeof m.getSettings()=="object")){const p=m.getCapabilities?m.getCapabilities():m.getSettings();p.focusMode?typeof p.facingMode=="string"&&p.facingMode===FacingMode.USER||((l=p.facingMode)===null||l===void 0?void 0:l[0])===FacingMode.USER?(f.push(p),s.push(createCameraOrderingMessage(FacingMode.USER,p,m,s.length+1,!0))):p.focusMode.some(v=>v===FocusMode.CONTINUOUS)?(n.push(p),s.push(createCameraOrderingMessage(FacingMode.ENVIRONMENT,p,m,s.length+1,!0))):s.push(createCameraOrderingMessage(FacingMode.ENVIRONMENT,p,m,s.length+1,!1)):(u.push(p),s.push(createCameraOrderingMessage(p.facingMode,p,m,s.length+1,!0))),m.stop()}}catch(c){if((c.name==="OverconstrainedError"||c instanceof OverconstrainedError)&&c.constraint!=="deviceId")throw new CameraHardwareError(`Error opening camera: ${d}. We have detected that the device is either not meeting the minimum technical specifications or the browser is not deciding to return the camera with the required resolution. Have you checked if vou are running the camera correctly elsewhere in the application?. ${c}`);if(c instanceof EvalError)throw new CameraHardwareError(`Error opening camera: ${d}. We have not detected any type of camera connected to the system, please try connecting a compatible camera for the process. ${c}`);if(c instanceof DOMException||c.message==="Could not start video source")throw new CameraHardwareError(`Error opening camera: ${d}. We have tried to start the camera, but it seems that the device is preventing us from starting it, is this a bug at the driver level? ${c}`)}return{sortedCameras:CameraModule.filterAndSortCameras({frontCameras:f,aceptedRearCameras:n,allDeviceCamerasFromAPI:u},r,o),loggerSortingCamerasMessages:s}}static async getUserMedia(t){try{return await navigator.mediaDevices.getUserMedia(t)}catch(r){throw r.name==="NotAllowedError"?t.audio?new MicrophonePermissionDenied:new CameraPermissionDenied:new CameraHardwareError}}static async grantVideoPermission(t){if("mediaDevices"in navigator&&typeof navigator.mediaDevices.getUserMedia<"u"){const r={video:!0,audio:t},l=(await CameraModule.getUserMedia(r)).getTracks();for(const f of l)f.stop()}else throw new CameraHardwareError("Media Devices not Available, please check if using a Secure Context and try again or use another compatible device.")}static async getCamera(t,r,o,l,f=""){if("mediaDevices"in navigator&&typeof navigator.mediaDevices.getUserMedia<"u"){const n=o===CAMERATYPE.User?FacingMode.USER:FacingMode.ENVIRONMENT;try{let u={video:{},audio:{}};f?u={video:{deviceId:{exact:f},width:t,height:r,facingMode:n},audio:l}:u={video:{deviceId:void 0,width:t,height:r,facingMode:n,focusMode:FocusMode.CONTINUOUS},audio:l};const s=await CameraModule.getUserMedia(u),a=s==null?void 0:s.getVideoTracks()[0];if(CameraModule.filterFraudCamera(a))throw new CameraHardwareError("Your device does not pass the minimum requeriments to launch the authentication process, no valid cameras detected within the used device.");if(a&&(typeof a.getCapabilities=="function"||typeof a.getSettings()=="object")){const c=a.getCapabilities?a.getCapabilities():a.getSettings();return{cameraInstance:s,id:c.deviceId,facingMode:c.facingMode}}return{cameraInstance:s,id:void 0,facingMode:void 0}}catch{const s={video:{width:t,height:r,facingMode:n},audio:l},a=await CameraModule.getUserMedia(s),d=a==null?void 0:a.getVideoTracks()[0],c=CameraModule.filterFraudCamera(d);if(c)throw new CameraHardwareError("Your device does not pass the minimum requeriments to launch the authentication process, no valid cameras detected within the used device.");if(d&&(typeof d.getCapabilities=="function"||typeof d.getSettings()=="object")){const m=d.getCapabilities?d.getCapabilities():d.getSettings();return{cameraInstance:a,id:c?void 0:m.deviceId,facingMode:c?void 0:m.facingMode}}return{cameraInstance:a,id:void 0,facingMode:void 0}}}else throw new CameraApiNoAvailableError}static async switchCamera(t,r,o,l,f){const n=r.getVideoTracks()[0].getSettings().deviceId;let u=-1,s=-1;for(let p=0;p<t.length;p++)if(t[p].deviceId===n){u=p;break}if(u===t.length-1?s=0:s=u+1,r){const p=r.getVideoTracks();for(const v of p)v.stop()}const a={video:{deviceId:t[s].deviceId,width:o,height:l},audio:f},d=await CameraModule.getUserMedia(a),c=d==null?void 0:d.getVideoTracks()[0];if(CameraModule.filterFraudCamera(c))throw new CameraHardwareError("Camera switch unsuccess, you tried to open an unauthorized camera.");if(c&&(typeof c.getCapabilities=="function"||typeof c.getSettings()=="object")){const p=c.getCapabilities?c.getCapabilities():c.getSettings();return{newCameraInstance:d,facingMode:p.facingMode}}return{newCameraInstance:d,facingMode:void 0}}static filterAndSortCameras(t,r,o){var l;t.frontCameras&&t.frontCameras.sort((n,u)=>n.focusMode.some(s=>s===FocusMode.CONTINUOUS)&&u.focusMode.every(s=>s!==FocusMode.CONTINUOUS)?-1:n.focusMode.every(s=>s!==FocusMode.CONTINUOUS)&&u.focusMode.some(s=>s===FocusMode.CONTINUOUS)?1:0),t.aceptedRearCameras&&t.aceptedRearCameras.sort((n,u)=>n.width&&u.width&&n.width.max>u.width.max&&u.width.max<1080?-1:n.width&&u.width&&n.width.max<u.width.max&&n.width.max<1080?1:n.iso&&u.iso&&n.iso.max>u.iso.max?-1:n.iso&&u.iso&&n.iso.max<u.iso.max?1:n.torch&&!u.torch?-1:!n.torch&&u.torch?1:0),t.allDeviceCamerasFromAPI.length>0&&(t.allDeviceCamerasFromAPI[0].facingMode||!((l=t.allDeviceCamerasFromAPI[0].facingMode)===null||l===void 0)&&l[0])&&t.allDeviceCamerasFromAPI.sort((n,u)=>{var s,a,d,c;return((s=n.facingMode)===null||s===void 0?void 0:s[0])===FacingMode.USER&&((a=u.facingMode)===null||a===void 0?void 0:a[0])===FacingMode.ENVIRONMENT||n.facingMode===FacingMode.USER&&u.facingMode===FacingMode.ENVIRONMENT?1:((d=n.facingMode)===null||d===void 0?void 0:d[0])===FacingMode.ENVIRONMENT&&((c=u.facingMode)===null||c===void 0?void 0:c[0])===FacingMode.USER||n.facingMode===FacingMode.ENVIRONMENT&&u.facingMode===FacingMode.USER?-1:0});let f=[];return t.allDeviceCamerasFromAPI.length>0&&t.allDeviceCamerasFromAPI[0].facingMode&&r===CAMERATYPE.User&&o?f=t.allDeviceCamerasFromAPI.slice().reverse():t.allDeviceCamerasFromAPI.length>0?f=t.allDeviceCamerasFromAPI:r===CAMERATYPE.User?f=t.frontCameras.concat(t.aceptedRearCameras):r===CAMERATYPE.Environment&&(f=t.aceptedRearCameras.concat(t.frontCameras)),f}static filterFraudCamera(t){if(!t)return!1;const r=t.label.toLowerCase();return cameraFilter.filter(l=>r.includes(l.toLowerCase())).length>0}}var EngineType;(function(e){e.Microblink="Microblink",e.Facephi="Facephi",e.FacephiDocumentReader="FacephiDocumentReader"})(EngineType||(EngineType={}));const fileTag="rules-manager-utils";function applyRulesByEngineType(e,t,r){if(e===EngineType.Microblink)return applyRulesForMBEngine(t,r);if(e===EngineType.FacephiDocumentReader)return applyRulesForFPDocumentReaderEngine(t,r)}function applyRulesForMBEngine(e,t){var r;if(t.extractionData){const o=config_store.countryFilter.find(l=>l===t.extractionData.documentCountryIssuerIso2);if(o){const l=(r=config_store.rules)===null||r===void 0?void 0:r[o];if(l){let f=!0;for(const{key:n,rule:u,value:s,documentTypes:a,documentSide:d}of l)if(f&&(!a||a.includes(t.extractionData.documentTypeString))&&(d===void 0||d===e))f=checkRule(n,u,s,t.extractionData[n]);else if(!f)return!1;return f}return Logger.printDebug(fileTag,"There are no rules to be applied for the scanned document. Check if rules provided are for the desired country document."),!0}return Logger.printWarning(this.fileTag,`Detected document from different nationality, was expecting ${this.__countryFilter} but captured ${t.extractionData.documentCountryIssuerIso2} instead`),!1}if(!t.extractionData)return!0}function applyRulesForFPDocumentReaderEngine(e,t){return t.extractionData&&console.log(`Engine rules not implemented. There are no rules: ${config_store.rules}, documentSide: ${e} or data from engine: ${t}`),!0}function checkRule(e,t,r,o){switch(t){case RuleTypes.EqualTo:return o===r?!0:(Logger.printDebug(fileTag,`Invalid document extraction, ${e} extracted field must have a length or value equal to ${r}`),!1);case RuleTypes.Contains:return o!=null&&o.includes(r)?!0:(Logger.printDebug(fileTag,`Invalid document extraction, ${e} extracted field must contain '${r}' on it`),!1);case RuleTypes.Required:return o&&r?!0:(Logger.printDebug(fileTag,`Invalid document extraction, ${e} extracted field value is required`),!1);case RuleTypes.MaxLength:return(o==null?void 0:o.length)<=r?!0:(Logger.printDebug(fileTag,`Invalid document extraction, ${e} extracted field max lenght must be equal or lower than ${r}`),!1);case RuleTypes.MinLength:return(o==null?void 0:o.length)>=r?!0:(Logger.printDebug(fileTag,`Invalid document extraction, ${e} extracted field min lenght must be equal or greater than ${r}`),!1);case RuleTypes.EqualLength:return(o==null?void 0:o.length)===r?!0:(Logger.printDebug(fileTag,`Invalid document extraction, ${e} extracted field lenght must be equal to ${r}`),!1)}}function isValidRuleSchema(e){return typeof e.key=="string"&&Object.values(RuleTypes).includes(e.rule)&&(typeof e.value=="string"||typeof e.value=="number"||typeof e.value=="boolean")&&(e.documentTypes===void 0||Array.isArray(e.documentTypes)&&e.documentTypes.every(t=>Object.values(EngineDocumentTypes).includes(t)))&&(e.documentSide===void 0||Object.values(DocumentSide).includes(e.documentSide))}function isValidCountryRules(e){return Array.isArray(e)&&e.every(isValidRuleSchema)}function areValidRules(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)&&Object.values(e).every(isValidCountryRules)}var Key;(function(e){e.Enter="Enter",e.Space=" "})(Key||(Key={}));function handleKeyDown(e,t,r){if(t.includes(e.key))return e.preventDefault(),r()}var countryISOMapping;(function(e){e.AF="AFG",e.AX="ALA",e.AL="ALB",e.DZ="DZA",e.AS="ASM",e.AD="AND",e.AO="AGO",e.AI="AIA",e.AQ="ATA",e.AG="ATG",e.AR="ARG",e.AM="ARM",e.AW="ABW",e.AU="AUS",e.AT="AUT",e.AZ="AZE",e.BS="BHS",e.BH="BHR",e.BD="BGD",e.BB="BRB",e.BY="BLR",e.BE="BEL",e.BZ="BLZ",e.BJ="BEN",e.BM="BMU",e.BT="BTN",e.BO="BOL",e.BA="BIH",e.BW="BWA",e.BV="BVT",e.BR="BRA",e.VG="VGB",e.IO="IOT",e.BN="BRN",e.BG="BGR",e.BF="BFA",e.BI="BDI",e.KH="KHM",e.CM="CMR",e.CA="CAN",e.CV="CPV",e.KY="CYM",e.CF="CAF",e.TD="TCD",e.CL="CHL",e.CN="CHN",e.HK="HKG",e.MO="MAC",e.CX="CXR",e.CC="CCK",e.CO="COL",e.KM="COM",e.CG="COG",e.CD="COD",e.CK="COK",e.CR="CRI",e.CI="CIV",e.HR="HRV",e.CU="CUB",e.CY="CYP",e.CZ="CZE",e.DK="DNK",e.DJ="DJI",e.DM="DMA",e.DO="DOM",e.EC="ECU",e.EG="EGY",e.SV="SLV",e.GQ="GNQ",e.ER="ERI",e.EE="EST",e.ET="ETH",e.FK="FLK",e.FO="FRO",e.FJ="FJI",e.FI="FIN",e.FR="FRA",e.GF="GUF",e.PF="PYF",e.TF="ATF",e.GA="GAB",e.GM="GMB",e.GE="GEO",e.DE="DEU",e.GH="GHA",e.GI="GIB",e.GR="GRC",e.GL="GRL",e.GD="GRD",e.GP="GLP",e.GU="GUM",e.GT="GTM",e.GG="GGY",e.GN="GIN",e.GW="GNB",e.GY="GUY",e.HT="HTI",e.HM="HMD",e.VA="VAT",e.HN="HND",e.HU="HUN",e.IS="ISL",e.IN="IND",e.ID="IDN",e.IR="IRN",e.IQ="IRQ",e.IE="IRL",e.IM="IMN",e.IL="ISR",e.IT="ITA",e.JM="JAM",e.JP="JPN",e.JE="JEY",e.JO="JOR",e.KZ="KAZ",e.KE="KEN",e.KI="KIR",e.KP="PRK",e.KR="KOR",e.KW="KWT",e.KG="KGZ",e.LA="LAO",e.LV="LVA",e.LB="LBN",e.LS="LSO",e.LR="LBR",e.LY="LBY",e.LI="LIE",e.LT="LTU",e.LU="LUX",e.MK="MKD",e.MG="MDG",e.MW="MWI",e.MY="MYS",e.MV="MDV",e.ML="MLI",e.MT="MLT",e.MH="MHL",e.MQ="MTQ",e.MR="MRT",e.MU="MUS",e.YT="MYT",e.MX="MEX",e.FM="FSM",e.MD="MDA",e.MC="MCO",e.MN="MNG",e.ME="MNE",e.MS="MSR",e.MA="MAR",e.MZ="MOZ",e.MM="MMR",e.NA="NAM",e.NR="NRU",e.NP="NPL",e.NL="NLD",e.AN="ANT",e.NC="NCL",e.NZ="NZL",e.NI="NIC",e.NE="NER",e.NG="NGA",e.NU="NIU",e.NF="NFK",e.MP="MNP",e.NO="NOR",e.OM="OMN",e.PK="PAK",e.PW="PLW",e.PS="PSE",e.PA="PAN",e.PG="PNG",e.PY="PRY",e.PE="PER",e.PH="PHL",e.PN="PCN",e.PL="POL",e.PT="PRT",e.PR="PRI",e.QA="QAT",e.RE="REU",e.RO="ROU",e.RU="RUS",e.RW="RWA",e.BL="BLM",e.SH="SHN",e.KN="KNA",e.LC="LCA",e.MF="MAF",e.PM="SPM",e.VC="VCT",e.WS="WSM",e.SM="SMR",e.ST="STP",e.SA="SAU",e.SN="SEN",e.RS="SRB",e.SC="SYC",e.SL="SLE",e.SG="SGP",e.SK="SVK",e.SI="SVN",e.SB="SLB",e.SO="SOM",e.ZA="ZAF",e.GS="SGS",e.SS="SSD",e.ES="ESP",e.LK="LKA",e.SD="SDN",e.SR="SUR",e.SJ="SJM",e.SZ="SWZ",e.SE="SWE",e.CH="CHE",e.SY="SYR",e.TW="TWN",e.TJ="TJK",e.TZ="TZA",e.TH="THA",e.TL="TLS",e.TG="TGO",e.TK="TKL",e.TO="TON",e.TT="TTO",e.TN="TUN",e.TR="TUR",e.TM="TKM",e.TC="TCA",e.TV="TUV",e.UG="UGA",e.UA="UKR",e.AE="ARE",e.GB="GBR",e.US="USA",e.UM="UMI",e.UY="URY",e.UZ="UZB",e.VU="VUT",e.VE="VEN",e.VN="VNM",e.VI="VIR",e.WF="WLF",e.EH="ESH",e.YE="YEM",e.ZM="ZMB",e.ZW="ZWE",e.XK="XKX"})(countryISOMapping||(countryISOMapping={}));function getCountryISO3(e){return countryISOMapping[e]}function getCountryISO2(e){for(const t in countryISOMapping)if(countryISOMapping[t]===e)return t;return""}var _a;class SpeechSynthesisModule{static __setSpeechUterance(t,r){const o=new SpeechSynthesisUtterance;return o.text=t,o.rate=1.2,o.lang=r,o.volume=_a.speechVolume,o}}_a=SpeechSynthesisModule;SpeechSynthesisModule.actualString="";SpeechSynthesisModule.isSpeaking=!1;SpeechSynthesisModule.speechVolume=1;SpeechSynthesisModule.Initialize=()=>{_a.actualString="",_a.speechVolume=1};SpeechSynthesisModule.CancelAudioTracks=()=>{_a.isSpeaking=!1,speechSynthesis.cancel()};SpeechSynthesisModule.ReadText=(e,t,r,o)=>{"speechSynthesis"in window&&(!_a.isSpeaking&&(_a.actualString!==e||r)&&(_a.isSpeaking=!0,_a.actualString=e,_a.speechInstance=_a.__setSpeechUterance(e,t),speechSynthesis.speak(_a.speechInstance)),_a.speechInstance.onend=()=>{_a.CancelAudioTracks(),_a.ReadText(e,t,r),o&&o()})};SpeechSynthesisModule.toggleVolume=()=>{_a.speechVolume?(_a.speechVolume=0,_a.Close()):_a.speechVolume=1};SpeechSynthesisModule.Close=()=>{_a.actualString="",_a.CancelAudioTracks()};SpeechSynthesisModule.getVolume=()=>_a.speechVolume;/*!
 * Built with Stencil
 * Copyright (c) 2023 Facephi Biometria, S.A.
 */var isMobile$1={exports:{}};isMobile$1.exports=isMobile;isMobile$1.exports.isMobile=isMobile;isMobile$1.exports.default=isMobile;const mobileRE=/(android|bb\d+|meego).+mobile|armv7l|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|samsungbrowser.*mobile|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,notMobileRE=/CrOS/,tabletRE=/android|ipad|playbook|silk/i;function isMobile(e){e||(e={});let t=e.ua;if(!t&&typeof navigator<"u"&&(t=navigator.userAgent),t&&t.headers&&typeof t.headers["user-agent"]=="string"&&(t=t.headers["user-agent"]),typeof t!="string")return!1;let r=mobileRE.test(t)&&!notMobileRE.test(t)||!!e.tablet&&tabletRE.test(t);return!r&&e.tablet&&e.featureDetect&&navigator&&navigator.maxTouchPoints>1&&t.indexOf("Macintosh")!==-1&&t.indexOf("Safari")!==-1&&(r=!0),r}var ThirdPartyAssemblyType;(function(e){e.AdvancedWithThreads="advanced-threads",e.Advanced="advanced",e.Basic="basic"})(ThirdPartyAssemblyType||(ThirdPartyAssemblyType={}));var ThirdPartyExtractorType;(function(e){e.Full="full",e.Lightweight="lightweight"})(ThirdPartyExtractorType||(ThirdPartyExtractorType={}));var ProductEngines;(function(e){e.FirstParty="FacephiDocumentReader",e.ThirdParty="Microblink"})(ProductEngines||(ProductEngines={}));export{ImageFormat as $,AdvancedTrackingModule as A,BROWSERLIST as B,ClickableEventElements as C,DocumentType as D,ExceptionType as E,FILTER_FAILED_DATA as F,DefaultEngineLocation as G,EVENT_TYPE as H,INFO_RESULT as I,TRACK_STATUS_TYPE as J,Key as K,Logger as L,TAP_BUTTON_TYPE as M,reset_config_store as N,reset_error_store as O,reset_internal_store as P,FacingMode as Q,ResultStatus as R,SpeechSynthesisModule as S,TUTORIAL_SLIDE_ALTS as T,BarcodeSide as U,LoggerLevel as V,WIDGETVIEWS as W,ASPECTRATIO as X,WIDGET_CONFIG as Y,VideoRecordQuality as Z,AnonymizationMode as _,DocumentSide as a,areValidRules as a0,applyRulesByEngineType as a1,IMAGEQUALITY as a2,DocumentTypeReader as a3,ExtractionResultStr as a4,DiagnosticStatus as a5,DocumentReaderResetMode as a6,ExtractionResult as a7,getCountryISO2 as a8,getCountryISO3 as a9,CAPTUREPADDING as aa,OperatingSystem as ab,bootstrapLazy as ac,ERROR_DATA$1 as ad,config_store as b,createEvent as c,DIAGNOSTIC_DATA as d,DIAGNOSTIC_ICONS as e,DataEventType as f,handleKeyDown as g,h,CameraType as i,getElement as j,error_store as k,ERROR_DATA as l,Fragment as m,internal_store as n,TUTORIAL_SLIDE_TEXTS as o,ExpectedSides as p,AdvancedTrackingType as q,registerInstance as r,WidgetVersion as s,IQA_READABILITY_TH_LOW as t,IQA_SHARPNESS_TH_LOW as u,IQA_UNDER_EXPOSURE_TH_HIGH as v,IQA_OVER_EXPOSURE_TH_HIGH as w,SelphidPhaseNames as x,Language as y,CameraModule as z};
